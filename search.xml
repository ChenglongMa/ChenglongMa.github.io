<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Tute1 -- Jupyter notebook FAQ</title>
    <url>/03/pds-tute1/</url>
    <content><![CDATA[<p>This post will give you some tips for <code>Jupyter notebook</code> configurations. For more useful details, please refer to <a href="https://jupyter-notebook-beginner-guide.readthedocs.io/en/latest/" target="_blank" rel="noopener">https://jupyter-notebook-beginner-guide.readthedocs.io/en/latest/</a>.</p>
<a id="more"></a>
<h2 id="How-to-change-the-default-directory-where-Jupyter-notebook-launched"><a href="#How-to-change-the-default-directory-where-Jupyter-notebook-launched" class="headerlink" title="How to change the (default) directory where Jupyter notebook launched?"></a>How to change the (default) directory where Jupyter notebook launched?</h2><ol>
<li><p>Start a <strong>Command Line Interface</strong> (cli) window. It is called <code>terminal</code> in MacOS while <code>Anaconda Prompt</code> in  Windows.</p>
</li>
<li><p><code>cd</code> <sup><a href="#fn_1" id="reffn_1">1</a></sup> into your desired folder/directory, e.g., <code>C:\pds\tute\</code> or <code>~/pds/tute</code>.</p>
<p><sup><a href="#fn_1" id="reffn_1">1</a></sup>:<code>cd</code> is short for <code>Change Directory</code>, a cli command to change the current working directory.</p>
</li>
<li><p>Type <code>jupyter notebook</code> to start a new Jupyter notebook app, as shown below:</p>
</li>
</ol>
<p><img alt="jupyter cli commands" data-src="/03/pds-tute1/image-20200318134418098.png"></p>
<p>Then, we can check whether the <code>Jupyter notebook</code> has started from the correct directory, see â‘¢ .</p>
<p>Now, the server has been active and you can visit <code>http://localhost:8888/</code> in your favourite browser, see â‘£. <strong>NB: the URL can vary depending on your OS and Jupyter version.</strong></p>
<h2 id="How-to-rename-the-ipynb-file"><a href="#How-to-rename-the-ipynb-file" class="headerlink" title="How to rename the .ipynb file?"></a>How to rename the <code>.ipynb</code> file?</h2><p>There are multiple options available:</p>
<ol>
<li><p>Click the filename (e.g., â€œUntitledâ€ ) in the top and type a new filename in the pop-up dialog.</p>
<p><img alt="rename file" data-src="/03/pds-tute1/image-20200318145202566.png"></p>
</li>
<li><p>Rename it from the home page:</p>
<ol>
<li>Tick the checkbox of the certain file;</li>
<li>Click the <strong>Rename</strong> button and type a new name;</li>
</ol>
<p><img alt="rename from home page" data-src="/03/pds-tute1/image-20200318145718915.png"></p>
<p><strong>NB: you must shut down the running notebook before renaming it.</strong></p>
</li>
<li><p>Enter your local directory (e.g., <code>C:\pds\tute\</code>) and find the untitled file and rename it.</p>
</li>
</ol>
<p><strong>NB: please note if you have permission to change the filename.</strong></p>
<h2 id="Why-the-iPython-prompts-cell-numbers-are-unordered-in-my-notebook"><a href="#Why-the-iPython-prompts-cell-numbers-are-unordered-in-my-notebook" class="headerlink" title="Why the iPython prompts (cell numbers) are unordered in my notebook?"></a>Why the iPython prompts (cell numbers) are unordered in my notebook?</h2><blockquote>
<p>iPython prompts are numbered, and each time you enter a command, this number will increase by 1. This makes it easy to repeat commands without typing them again.</p>
</blockquote>
<p>The cell numbers indicate <strong>the order you run the scripts</strong>. Say if you run <code>x = range(100)</code> again after <code>plt.plot(x,y)</code>, the <code>In [2]</code> will become <code>In [5]</code> as shown below:</p>
<p><img alt="cell numbers" data-src="/03/pds-tute1/image-20200318151423477.png"></p>
<p>You can recall it using the Jupyter <strong>magic</strong> commands which start with a <code>%</code> sign (e.g., <code>%history</code>, <code>%rerun</code>).</p>
<h3 id="How-to-reset-the-number-then"><a href="#How-to-reset-the-number-then" class="headerlink" title="How to reset the number then?"></a>How to reset the number then?</h3><p>Well, you can rerun all the cells via the <code>Kernel</code> menu but you cannot reset the numbers without rerunning them.</p>
<p><img alt="rerun all" data-src="/03/pds-tute1/image-20200318154635393.png"></p>
<h2 id="How-to-use-â€œtab-completionâ€"><a href="#How-to-use-â€œtab-completionâ€" class="headerlink" title="How to use â€œtab-completionâ€?"></a>How to use â€œtab-completionâ€?</h2><p>You may have seen many hackers type commands quickly, and so can youğŸ˜‰.</p>
<p>Generally, cli apps support <strong>tab-completion</strong>, i.e., you can auto-complete commands/paths by pressing <kbd>Tab</kbd> button on your keyboard <strong>if what you have typed can uniquely identify a certain command/file</strong>:</p>
<p><img alt="image-20200318160240988" style="zoom:25%;" data-src="/03/pds-tute1/image-20200318160240988.png"></p>
<p>For example, you can type <code>cd C:\pds\t</code> and get <code>cd C:\pds\tute</code> after pressing <kbd>Tab</kbd> button.</p>
<p>Fortunately, Jupyter supports this feature as well in our notebook. Try this:</p>
<p><strong>impor<kbd>Tab</kbd><kbd>Space</kbd>matp<kbd>Tab</kbd></strong></p>
<p><img alt="tab_completion" data-src="/03/pds-tute1/tab_completion.gif"></p>
<h2 id="Some-useful-shortcuts-for-Jupyter-notebook"><a href="#Some-useful-shortcuts-for-Jupyter-notebook" class="headerlink" title="Some useful shortcuts for Jupyter notebook"></a>Some useful shortcuts for Jupyter notebook</h2><p><img alt="shortcuts" data-src="/03/pds-tute1/image-20200319232819538.png"></p>
<p>Before we continue, Iâ€™d like to introduce two modes for the notebook: <strong>Edit</strong> mode and <strong>Command</strong> mode. A basic introduction is available at: <a href="https://jupyter-notebook.readthedocs.io/en/stable/examples/Notebook/Notebook Basics.html#Modal-editor" target="_blank" rel="noopener">here</a>. So, there are different shortcuts for each mode.</p>
<h3 id="Command-mode"><a href="#Command-mode" class="headerlink" title="Command mode"></a>Command mode</h3><ol>
<li><p><kbd>H</kbd></p>
<p>Open the shortcuts list.</p>
</li>
<li><p>Double click <kbd>D</kbd></p>
<p><strong>D</strong>elete selected cells.</p>
</li>
<li><p><kbd>A</kbd></p>
<p>Insert cell <strong>a</strong>bove.</p>
</li>
<li><p><kbd>B</kbd></p>
<p>Insert cell <strong>b</strong>elow.</p>
</li>
<li><p><kbd>C</kbd></p>
<p><strong>C</strong>opy selected cells.</p>
</li>
<li><p><kbd>V</kbd></p>
<p>Paste cells below.</p>
</li>
</ol>
<h3 id="Edit-mode"><a href="#Edit-mode" class="headerlink" title="Edit mode"></a>Edit mode</h3><ol>
<li><p><kbd>Ctrl</kbd> + <kbd>Shift</kbd>  + <kbd>P</kbd> (or <kbd>Cmd</kbd> + <kbd>Shift</kbd>  + <kbd>P</kbd> for Mac OS)</p>
<p>Open shortcuts list.</p>
</li>
<li><p><kbd>Ctrl</kbd> + <kbd>Enter</kbd></p>
<p>Run cell.</p>
</li>
<li><p><kbd>Alt</kbd> + <kbd>Enter</kbd></p>
<p>Run cell and <strong>insert a new cell below</strong>.</p>
</li>
<li><p><kbd>Ctrl</kbd> + <kbd>Shift</kbd>  + <kbd>-</kbd> (Minus button)</p>
<p>Split cell at cursor.</p>
</li>
</ol>
]]></content>
      <categories>
        <category>Practical Data Science</category>
      </categories>
      <tags>
        <tag>notes</tag>
      </tags>
  </entry>
  <entry>
    <title>ElGamal Encryption</title>
    <url>/10/elgamal/</url>
    <content><![CDATA[<h1 id="ElGamal-Encryption-Algorithm"><a href="#ElGamal-Encryption-Algorithm" class="headerlink" title="ElGamal Encryption Algorithm"></a>ElGamal Encryption Algorithm</h1><p>The Elgamal encryption scheme is an asymmetric key encryption algorithm which consists of three phases (i.e., key generation, encryption, decryption). It is based on the <em>Diffie-Hellman</em> key exchange and defined over a cyclic group $ G $. Therefore, its security relies heavily on Discrete-log based building blocks.</p>
<p><strong>This algorithm can be tested at <a href="https://chenglongma.com/simple-elgamal/">here</a>.</strong></p>
<a id="more"></a>
<h2 id="Configuration"><a href="#Configuration" class="headerlink" title="Configuration"></a>Configuration</h2><p>The Elgamal algorithm is defined on a cyclic group so that it should be safe to select a prime $ p $ to generate a prime order group $ Z_p^\star $. Then we need to choose a prime $ q $ to define a unique subgroup $ G_q $ and $ g \in Z_p^\star $ is one of its generators where $ p = \gamma q + 1 $, $\gamma$ is a specific integer.</p>
<h2 id="Key-Generation"><a href="#Key-Generation" class="headerlink" title="Key Generation"></a>Key Generation</h2><p>To generate the <em>public</em> key of Elgamal, we firstly pick a random $ x $ as the <em>private</em> key where $ x \in \left( 0,q \right)  $. Then we get the public key $ \left\lbrace p,g,y \right\rbrace  $:</p>
<script type="math/tex; mode=display">
\begin{equation}
\left\lbrace p,g,y \right\rbrace = \left\lbrace p,g, g^x \mod p \right\rbrace,
\tag{1}
\end{equation}</script><p>now we can pass this public key triplets to anyone who wants to send his\slash her encrypted message to us. The following is an example of key generation phase:</p>
<p><img alt="key-generation" data-src="/10/elgamal/key_gen.png"></p>
<p>It should be noted that $ y $ can be calculated by <em>Fast Exponentiation Methods</em> whose pseudo-code is shown in following:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fast_exponentiation</span><span class="params">(x, exp, n)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    res = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(exp):</span><br><span class="line">        res = (res * x) % n</span><br><span class="line">    <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>
<h2 id="Encryption"><a href="#Encryption" class="headerlink" title="Encryption"></a>Encryption</h2><p>Assume that we encrypt a message $ m  \in (0,p)$ using the above configured ElGamal. First, we need to choose an integer $ k \in (0,q) $ randomly. Then, we get the cipher pair $ \left\lbrace  c_1, c_2 \right\rbrace  $:</p>
<script type="math/tex; mode=display">
\begin{equation}
\begin{cases}
    c_1 &= g^k \mod p\newline
    c_2 &= y^k \cdot m \mod p
\end{cases}
\tag{2}
\end{equation}</script><p>Based on the example shown in the figure of <strong>key generation</strong> phase and setting $ m=100,k=89 $, we can easily get the cipher is:</p>
<script type="math/tex; mode=display">
\begin{align}
    \left\lbrace  c_1, c_2 \right\rbrace &= \left\lbrace  g^k \mod p, y^k \cdot m \mod p \right\rbrace \nonumber\newline
    &= \left\lbrace  100^{89} \mod 809, 65^{89} \cdot 100 \mod 809 \right\rbrace \nonumber\newline
    &= \left\lbrace  345, 517 \right\rbrace,
    \tag{2.1}
\end{align}</script><p>the result will be:</p>
<p><img alt="encryption" data-src="/10/elgamal/encryption.png"></p>
<h2 id="Decryption"><a href="#Decryption" class="headerlink" title="Decryption"></a>Decryption</h2><p>With the private key $ x $, we can decode the cipher pair $ \left\lbrace  c_1, c_2 \right\rbrace  $ to get the plaintext $ m $:</p>
<script type="math/tex; mode=display">
\begin{equation}
m = \frac{C_2}{C_1^x} \mod p = C_2 \cdot C_1^{-x} \mod p
\tag{3}
\end{equation}</script><p>where $ (C_1^{-x} \mod p) $ is the inverse of $ (C_1^{x} \mod p) $ that $ (C_1^{-x}\cdot C_1^{x} \equiv 1 \mod p) $. There are multiple methods to solve this equation. We implement an <em>Extended Euclidean algorithm</em> to get the <strong>inverse</strong>, see the code following (refer to <a href="https://en.wikipedia.org/wiki/Extended_Euclidean_algorithm" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Extended_Euclidean_algorithm</a>): </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inverse</span><span class="params">(a, n)</span>:</span></span><br><span class="line">    (t, newt) = (<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    (r, newr) = (n, a)</span><br><span class="line">    <span class="keyword">while</span> newr:</span><br><span class="line">        quotient = r // newr</span><br><span class="line">        (t, newt) = (newt, t - quotient * newt)</span><br><span class="line">        (r, newr) = (newr, r - quotient * newr)</span><br><span class="line">    <span class="keyword">if</span> r &gt;= <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">'a is not invertible.'</span>)</span><br><span class="line">    <span class="keyword">if</span> t &lt;= <span class="number">0</span>:</span><br><span class="line">        t += n</span><br><span class="line">    <span class="keyword">return</span> t</span><br></pre></td></tr></table></figure>
<p>Continued with the above example, we can get:</p>
<script type="math/tex; mode=display">
\begin{align}
\begin{split}
    m &= \frac{C_2}{C_1^x} \mod p = C_2 \cdot C_1^{-x} \mod p\\
      &= (517 \times 720) \mod 809\\
      &= 100
\end{split}
\tag{3.1}
\end{align}</script><p>Finally, we complete all the tree phases of Elgamal:</p>
<p><img alt="decryption" data-src="/10/elgamal/decryption.png"></p>
<h2 id="Homomorphic-Property-of-ElGamal"><a href="#Homomorphic-Property-of-ElGamal" class="headerlink" title="Homomorphic Property of ElGamal"></a>Homomorphic Property of ElGamal</h2><p><em>Homomorphic encryption</em> allows users to perform calculations on the <em>ciphers</em> and bring the calculated encrypted results into correspondence with the results of operated on the <em>plaintexts</em>. It enables the black-box operations on cipher messages and improves the security of the information transfer process. Elgamal is an implementation of homomorphic encryption. The multiplicative operation between two ciphers of $ m_1 $ and $ m_2 $ is as follows:</p>
<script type="math/tex; mode=display">
\begin{align}
\begin{split}
    C_1 = (c_1,c_2) &= (g^k \mod p, y^k \cdot m_1 \mod p)\newline
    C_2 = (c'_1,c'_2) &= (g^{k'} \mod p, y^{k'} \cdot m_2 \mod p)
\end{split}
\tag{4}
\end{align}</script><p>The product of $ C_1 $ and $ C_2 $ is:</p>
<script type="math/tex; mode=display">
\begin{align}
\begin{split}
    C_1 \cdot C_2 &= (c_1,c_2) \cdot (c'_1,c'_2)\\
                  &= (g^{k+k'} \mod p, y^{k+k'} \cdot (m_1 \cdot m_2) \mod p)
\end{split}
\tag{5}
\end{align}</script><p>Then, we get decryption of $ C_1 \cdot C_2 $ and verify if it equals the product of $ m_1 $ and $ m_2 $:</p>
<script type="math/tex; mode=display">
\begin{align}
\begin{split}
&D[(g^{k+k'}, y^{k+k'} \cdot (m_1 \cdot m_2))]
    = \frac{(y^{k+k'} \cdot (m_1 \cdot m_2))}{(g^{x \cdot (k+k')})} \mod p\\
&= m_1 \cdot m_2 \mod p
\end{split}
\tag{6} \label{hom}
\end{align}</script><p>Based on the deduction of Equ.$\eqref{hom}$, we have verified the homomorphic property of ElGamal, which is also demonstrated in our implementation. We randomly choose 5 integer messages $ [m_1, m_2, \cdots, m_5] $ and 5 random integer $ k $ $ [k_1, k_2, \cdots, k_5] $, then encrypt them respectively. Finally, we calculate the products of each pair and the output has proved the homomorphic property of ElGamal as well, shown in below.</p>
<p><img alt="hom" data-src="/10/elgamal/hom.png"></p>
]]></content>
      <categories>
        <category>Cryptography</category>
      </categories>
      <tags>
        <tag>ElGamal</tag>
      </tags>
  </entry>
  <entry>
    <title>Simple Keccak</title>
    <url>/10/simple-keccak/</url>
    <content><![CDATA[<h1 id="Keccak-f-25"><a href="#Keccak-f-25" class="headerlink" title="Keccak-$ f[25] $"></a>Keccak-$ f[25] $</h1><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Keccak is an implementation of SHA-3 Cryptographic Hash Algorithm. In this report, we discuss a lightweight version Keccak where we set state $ b = 25 = 5 \times 5 \times 2^l $ in its Sponge stage. I.e., $ l=0 $ and thus there is only one slice ($ 5 \times 5 $ bits) and 12 rounds as $ n_rounds = 12 + 2l $. Each round function consists of 5 steps to process the state: $ { \theta \rightarrow \rho \rightarrow \pi \rightarrow \chi \rightarrow \iota } $. The output of former step would be treated as the input of next, likewise, the output of $ \iota $ step will be feed into $ \theta $ step of next round. We implement 4 of them in this project ( $ \rho $ step excluded). We will discuss these steps in detail in the following sections.</p>
<p><strong>The implementation of this report can be accessed at <a href="https://chenglongma.com/simple-keccak/">here</a>.</strong></p>
<a id="more"></a>
<h2 id="theta-Step"><a href="#theta-Step" class="headerlink" title="$\theta$ Step"></a>$\theta$ Step</h2><p>The $\theta$ Step is defined as below: </p>
<script type="math/tex; mode=display">
\begin{cases}
C[x] = A[x,0] \oplus A[x,1] \oplus A[x,2] \oplus A[x,3] \oplus A[x,4] ,& x \in [0,4] \newline 
D[x] = C[x-1] \oplus rot(C[x+1],1), & x \in [0,4] \newline 
A[x,y] = A[x,y] \oplus D[x] , & x,y \in [0,4] \newline 
\end{cases} \tag{1}</script><p>where $ A[x,y] $ indicates the lane in column $ x $ and row $ y $; thus $ C[x] $ is a bitwise $ XOR $ summation between all rows of column $ x $. Then, $ rot(C[x+1], 1) $ rotates the bits within the lane $ C[x] $. Particularly, as there is only slice in our implementation, the $ rot $ function makes no changes so that $ rot(C[x+1], 1) = C[x+1] $. Thereafter, $ D[x] $ combines $ C[x-1] $ and $ C[x+1] $ by $ XOR $ summation. Finally, the output of each single value in $ A[] $ of this step obtains from the original $ A[x,y]\ XOR\ D[x]$.</p>
<p>An example of this step is shown below, including input and all outputs of intermediate steps.</p>
<p><img alt="theta" data-src="/10/simple-keccak/theta.png"></p>
<p>The origin of coordinates in each matrix (i.e.\  $ A[0,0] $) locates at the left bottom. Take $ A[2,3] $ as an example, the input is $ 0 $ and the output of intermediate steps are:</p>
<script type="math/tex; mode=display">
\begin{equation}
\begin{split}
C[2]&= A[2,0] \oplus A[2,1] \oplus A[2,2] \oplus A[2,3] \oplus A[2,4]\newline 
    &= 0 \oplus 0 \oplus 1 \oplus 0 \oplus 0\newline 
    &= 1\newline 
D[2]&= C[1]  \oplus C[3]\newline 
    &= 0 \oplus 0\newline 
    &= 0\newline 
A'[2,3] &= A[2,3]  \oplus D[2]\newline 
        &= 0 \oplus 0\newline 
        &= 0\newline 
\end{split} \tag{2}  \label{eq:theta}
\end{equation}</script><h2 id="pi-Step"><a href="#pi-Step" class="headerlink" title="$\pi$ Step"></a>$\pi$ Step</h2><p>Differ from the other 3 steps, which are all <em>substitution</em> functions, $\pi$ step is a <em>permutation</em> function. The output of $\theta$ step will put into $\pi$ step as initial input. The $\pi$ step is defined as:</p>
<script type="math/tex; mode=display">
A'[y, 2x+3y] = rot(A[x,y], r[x,y]), x,y \in [0,4], \tag{3}</script><p>likewise as $\theta$ step, $ x $ and $ y $ represent the index of <em>column</em> and <em>row</em> respectively (the same below). $ rot $ function would also make no effects.</p>
<p>Continued from the example of  $\theta$ step $\eqref{eq:theta}$, the $\pi$ step is illustrated below:</p>
<p><img alt="pi" data-src="/10/simple-keccak/pi.png"></p>
<p>As shown above, the value of $ A[2,3] $ would be assigned to $ Aâ€™[3, (2\times2+3\times3) \mod 5] = Aâ€™[3,3] $, i.e., $ Aâ€™[3,3] = A[2,3] = 0 $.</p>
<h2 id="chi-Step"><a href="#chi-Step" class="headerlink" title="$\chi$ Step"></a>$\chi$ Step</h2><p>The output of $ Aâ€™[x,y] $ in $\chi$ step is determined by $ \bar{A}[x+1,y]$ and $ A[x+2,y] $, the complete definition is:</p>
<script type="math/tex; mode=display">
\begin{equation}
A'[x,y] = A[x,y] \oplus (\bar{A}[x+1,y] \wedge A[x+2,y]) , x,y \in [0,4],
\tag{4} \label{chi}
\end{equation}</script><p>where $ \bar{A}[x+1,y] $ is the $ NOT $ operation of $ A[x+1,y] $. This step can be illustrated as the following graph:</p>
<p><img alt="chi_demonstration" data-src="/10/simple-keccak/chi_demo.png"></p>
<p>Therefore, $ A[2,3] $ would be substituted as:</p>
<script type="math/tex; mode=display">
\begin{align}
\begin{split}
A'[2,3] &= A[2,3] \oplus (\bar{A}[3,3] \wedge A[4,3])\\
        &= 1 \oplus (1 \wedge 1)\\
        &= 0
\end{split} \tag{5} \label{eq:chi}
\end{align}</script><p>The complete intermediate outputs are:</p>
<p><img alt="chi" data-src="/10/simple-keccak/chi.png"></p>
<h2 id="iota-Step"><a href="#iota-Step" class="headerlink" title="$\iota$ Step"></a>$\iota$ Step</h2><p>The $\iota$ step is the final step of one round in Keccak. It introduces a set of <em>round constants</em> and combines $ A[0,0] $ with one of them (pick a different value for each round) by $ XOR $ summation, as shown below (Equ. $\eqref{iota}$).<br>The rest of matrix would remain their values unchanged.</p>
<script type="math/tex; mode=display">
\begin{equation}
A'[0,0] = A[0,0] \oplus RC[i_r],
\tag{6} \label{iota}
\end{equation}</script><p>where $ RC[] $ is the rounds constants array and $ i_r $ equals the current round index. It should be noted that each slice in the state of Keccak should $ XOR $ the <em>slice$ ^{th} $</em> bit in $ RC[i_r] $ from the leftmost (e.g., in our implementation, only the <em>leftmost</em> bit of $ RC[i_r] $ is used). Based on this, we get our final output of the first round:</p>
<p><img alt="iota" data-src="/10/simple-keccak/iota.png"></p>
<h2 id="Rounds"><a href="#Rounds" class="headerlink" title="Rounds"></a>Rounds</h2><p>As mentioned at the beginning of this section, there are $ 12 $ rounds in our implementation. For each round, we feed the final output of the $\iota$ step into the $\theta$ step of next round and switch the round constants to next index. The last round of Keccak-$ f[25] $ is shown below:</p>
<p><img alt="final" data-src="/10/simple-keccak/final.png"></p>
]]></content>
      <categories>
        <category>Cryptography</category>
      </categories>
      <tags>
        <tag>keccak</tag>
      </tags>
  </entry>
  <entry>
    <title>è®¾è®¡æ¨¡å¼æ€»ç»“</title>
    <url>/11/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬æ–‡æ—¨åœ¨å¸®åŠ©å¤ä¹ <strong>è®¾è®¡æ¨¡å¼</strong>ç›¸å…³æ¦‚å¿µï¼ŒåªåŒ…å«ç®€ç•¥è¦ç‚¹ï¼Œéè¯¦ç»†ä»‹ç»ã€‚</p>
<a id="more"></a>
<h2 id="è®¾è®¡æ¨¡å¼ç±»å‹"><a href="#è®¾è®¡æ¨¡å¼ç±»å‹" class="headerlink" title="è®¾è®¡æ¨¡å¼ç±»å‹"></a>è®¾è®¡æ¨¡å¼ç±»å‹</h2><h3 id="åˆ›å»ºå‹-Creational-Patterns-5"><a href="#åˆ›å»ºå‹-Creational-Patterns-5" class="headerlink" title="åˆ›å»ºå‹ Creational Patterns (5):"></a>åˆ›å»ºå‹ Creational Patterns (5):</h3><p>â€‹    <em>abstract the object instantiation process.</em></p>
<ol>
<li><strong>å·¥å‚æ–¹æ³•æ¨¡å¼ factory</strong></li>
<li>æŠ½è±¡å·¥å‚ abstractFactory</li>
<li><strong>å•ä¾‹æ¨¡å¼ singleton</strong></li>
<li>å»ºé€ è€…æ¨¡å¼ builder</li>
<li>åŸå‹æ¨¡å¼ prototype</li>
</ol>
<h3 id="ç»“æ„å‹-Structural-Patterns-7"><a href="#ç»“æ„å‹-Structural-Patterns-7" class="headerlink" title="ç»“æ„å‹ Structural Patterns (7):"></a>ç»“æ„å‹ Structural Patterns (7):</h3><p>â€‹    <em>describe how classes and objects can be combined to form larger structures.</em></p>
<ol>
<li>æ¡¥æ¥æ¨¡å¼bridge</li>
<li><strong>é€‚é…å™¨æ¨¡å¼adapter</strong></li>
<li>è£…é¥°å™¨æ¨¡å¼decorator</li>
<li><strong>ç»„åˆæ¨¡å¼composite</strong></li>
<li>äº«å…ƒæ¨¡å¼flyweight</li>
<li><strong>å¤–è§‚æ¨¡å¼facade</strong></li>
<li>ä»£ç†æ¨¡å¼proxy</li>
</ol>
<h3 id="è¡Œä¸ºå‹-Behavioural-Patterns-11"><a href="#è¡Œä¸ºå‹-Behavioural-Patterns-11" class="headerlink" title="è¡Œä¸ºå‹ Behavioural Patterns (11):"></a>è¡Œä¸ºå‹ Behavioural Patterns (11):</h3><p>â€‹    <em>are most specifically concerned with communication between objects.</em></p>
<ol>
<li><p>æ¨¡æ¿æ–¹æ³•æ¨¡å¼template</p>
</li>
<li><p><strong>ç­–ç•¥æ¨¡å¼strategy</strong></p>
<p><em>ä¸¤ä¸ªç±»ä¹‹é—´:</em></p>
</li>
<li><p><strong>è§‚å¯Ÿè€…æ¨¡å¼observer</strong></p>
</li>
<li><p>è¿­ä»£å­æ¨¡å¼iteratorï¼ˆå®¹å™¨ä¸å®¹å™¨éå†ï¼‰</p>
</li>
<li><p>è´£ä»»é“¾æ¨¡å¼chain of responsibilityï¼ˆè´£ä»»é“¾æ¨¡å¼ï¼‰ï¼ˆä¸²çš„æ›¿æ¢â€”-å¯ä»¥ä½¿ç”¨é“¾å¼æ“ä½œï¼‰</p>
</li>
<li><p>å‘½ä»¤æ¨¡å¼command</p>
<p><em>ç±»çš„çŠ¶æ€ï¼š</em></p>
</li>
<li><p>å¤‡å¿˜å½•æ¨¡å¼memento</p>
</li>
<li><p>çŠ¶æ€æ¨¡å¼state</p>
<p><em>é€šè¿‡ä¸­é—´ç±»ï¼š</em></p>
</li>
<li><p>è®¿é—®è€…æ¨¡å¼visitor</p>
</li>
<li><p>ä¸­ä»‹æ¨¡å¼mediator</p>
</li>
<li><p>è§£é‡Šå™¨æ¨¡å¼interpreter  </p>
</li>
</ol>
<h2 id="Adapter-é€‚é…å™¨æ¨¡å¼"><a href="#Adapter-é€‚é…å™¨æ¨¡å¼" class="headerlink" title="Adapter é€‚é…å™¨æ¨¡å¼"></a>Adapter é€‚é…å™¨æ¨¡å¼</h2><h3 id="ç±»å›¾ï¼š"><a href="#ç±»å›¾ï¼š" class="headerlink" title="ç±»å›¾ï¼š"></a>ç±»å›¾ï¼š</h3><p><img alt="Adapter Pattern Diagram" data-src="/11/è®¾è®¡æ¨¡å¼æ€»ç»“/adapter.png"></p>
<h3 id="ä»£ç ç¤ºä¾‹ï¼š"><a href="#ä»£ç ç¤ºä¾‹ï¼š" class="headerlink" title="ä»£ç ç¤ºä¾‹ï¼š"></a>ä»£ç ç¤ºä¾‹ï¼š</h3><p>åŸæœ‰ç¨‹åºä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Context</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// è¿™é‡Œåªæ˜¯æä¾›ä¸€ç§åº”ç”¨åœºæ™¯ï¼Œ</span></span><br><span class="line">        <span class="comment">// å¹¶éå¿…é¡»è¦ switch æˆ–è€… for loop</span></span><br><span class="line">        oldTest();</span><br><span class="line">        newTest();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Adapter ç‰ˆè°ƒç”¨æ–¹å¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">newTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        IShapeAdapter[] shapes = &#123;</span><br><span class="line">                <span class="keyword">new</span> ILineAdapter(),</span><br><span class="line">                <span class="keyword">new</span> IRectangleAdapter(),</span><br><span class="line">                <span class="keyword">new</span> IWeatherMapAdapter()</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// A begin and end point from a graphical editor</span></span><br><span class="line">        Point p1 = <span class="keyword">new</span> Point(<span class="number">10</span>, <span class="number">20</span>);</span><br><span class="line">        Point p2 = <span class="keyword">new</span> Point(<span class="number">30</span>, <span class="number">60</span>);</span><br><span class="line">        <span class="keyword">for</span> (IShapeAdapter shape : shapes) &#123;</span><br><span class="line">            <span class="comment">// ç»Ÿä¸€äº†è°ƒç”¨æ–¹æ³•ç­¾å</span></span><br><span class="line">            shape.draw(p1, p2);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŸç‰ˆè°ƒç”¨æ–¹å¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">oldTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Object[] shapes = &#123;<span class="keyword">new</span> LineGraphic(), <span class="keyword">new</span> RectangleGraphic()&#125;;</span><br><span class="line">        <span class="comment">// A begin and end point from a graphical editor</span></span><br><span class="line">        Point p1 = <span class="keyword">new</span> Point(<span class="number">10</span>, <span class="number">20</span>);</span><br><span class="line">        Point p2 = <span class="keyword">new</span> Point(<span class="number">30</span>, <span class="number">60</span>);</span><br><span class="line">        <span class="keyword">for</span> (Object shape : shapes)</span><br><span class="line">            <span class="keyword">if</span> (shape.getClass().getName().equals(<span class="string">"Line"</span>))</span><br><span class="line">                ((LineGraphic) shape).drawLine(p1, p2);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (shape.getClass().getName().equals(<span class="string">"Rectangle"</span>))</span><br><span class="line">                ((RectangleGraphic) shape).drawRect(</span><br><span class="line">                        <span class="keyword">new</span> Point(Math.min(p1.x, p2.x), Math.min(p1.y, p2.y)),</span><br><span class="line">                        Math.abs(p2.x - p1.x), Math.abs(p2.y - p1.y)</span><br><span class="line">                );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">LineGraphic</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">drawLine</span><span class="params">(Point p1, Point p2)</span> </span>&#123;</span><br><span class="line">            <span class="comment">// Stub for testing replacing real library call</span></span><br><span class="line">            System.out.println(<span class="string">"line from "</span> + p1 + <span class="string">" to "</span> + p2);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">RectangleGraphic</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">drawRect</span><span class="params">(Point p, <span class="keyword">int</span> width, <span class="keyword">int</span> height)</span> </span>&#123;</span><br><span class="line">            <span class="comment">// Stub for testing replacing real library call</span></span><br><span class="line">            System.out.println(<span class="string">"rectangle at "</span> + p + <span class="string">" with width "</span> + width</span><br><span class="line">                    + <span class="string">" and height "</span> + height);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">WeatherMapGraphic</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">drawCurrent</span><span class="params">(<span class="keyword">int</span> length, Point p)</span> </span>&#123;</span><br><span class="line">            System.out.println(<span class="string">"WeatherMapGraphic drawCurrent was called"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸‹ä¸ºæ–°å¢ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Adapter æ¥å£</span></span><br><span class="line"><span class="comment">// 1. ç»Ÿä¸€æ–¹æ³•ç­¾å</span></span><br><span class="line"><span class="comment">// 2. ä¸ºå¯èƒ½çš„æ–°å¢åŠŸèƒ½æä¾›æ¥å£è§„èŒƒ</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IShapeAdapter</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">draw</span><span class="params">(Point p1, Point p2)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å„ä¸ªAdapterä¸­å­˜åœ¨å‚æ•°ç±»å‹è½¬æ¢ä»¥é€‚åº”æ–°æ¥å£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ILineAdapter</span> <span class="keyword">implements</span> <span class="title">IShapeAdapter</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Context.LineGraphic adaptee = <span class="keyword">new</span> Context.LineGraphic();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">draw</span><span class="params">(Point p1, Point p2)</span> </span>&#123;</span><br><span class="line">        adaptee.drawLine(p1, p2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IRectangleAdapter</span> <span class="keyword">implements</span> <span class="title">IShapeAdapter</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Context.RectangleGraphic adaptee = <span class="keyword">new</span> Context.RectangleGraphic();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">draw</span><span class="params">(Point p1, Point p2)</span> </span>&#123;</span><br><span class="line">        adaptee.drawRect(<span class="keyword">new</span> Point(Math.min(p1.x, p2.x), Math.min(p1.y, p2.y)),</span><br><span class="line">                Math.abs(p2.x - p1.x), Math.abs(p2.y - p1.y));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IWeatherMapAdapter</span> <span class="keyword">implements</span> <span class="title">IShapeAdapter</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Context.WeatherMapGraphic adaptee = <span class="keyword">new</span> Context.WeatherMapGraphic();</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">draw</span><span class="params">(Point p1, Point p2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> length = Math.abs(p2.x - p1.x);</span><br><span class="line">        Point p = <span class="keyword">new</span> Point(Math.min(p1.x, p2.x), Math.min(p1.y, p2.y));</span><br><span class="line">        adaptee.drawCurrent(length, p);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å…³é”®è¯"><a href="#å…³é”®è¯" class="headerlink" title="å…³é”®è¯:"></a>å…³é”®è¯:</h3><p><em>incompatible, different interfaces, different methods (method signature)</em></p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>å½“å‡ºç°ä»¥ä¸Šå…³é”®è¯æˆ–è€…åœ¨Class Diagramé‡Œå„ä¸ª<strong>ç›¸ä¼¼</strong>çš„ç±»ï¼Œæ–¹æ³•åæˆ–æ–¹æ³•ç­¾åï¼ˆ<em>ç­¾ååŒ…æ‹¬æ–¹æ³•åå’Œå‚æ•°åˆ—è¡¨</em>ï¼‰ä¸åŒæ—¶ï¼Œåº”è¯¥ä½¿ç”¨Adapter patternã€‚</p>
<h2 id="Factory-not-GoF-ç®€å•å·¥å‚æ¨¡å¼"><a href="#Factory-not-GoF-ç®€å•å·¥å‚æ¨¡å¼" class="headerlink" title="Factory (not GoF) ç®€å•å·¥å‚æ¨¡å¼"></a>Factory (not GoF) ç®€å•å·¥å‚æ¨¡å¼</h2><h3 id="ä»£ç ç¤ºä¾‹ï¼š-1"><a href="#ä»£ç ç¤ºä¾‹ï¼š-1" class="headerlink" title="ä»£ç ç¤ºä¾‹ï¼š"></a>ä»£ç ç¤ºä¾‹ï¼š</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IShape</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Circle</span> <span class="keyword">implements</span> <span class="title">IShape</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Inside Circle::draw() method."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Rectangle</span> <span class="keyword">implements</span> <span class="title">IShape</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Inside Rectangle::draw() method."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Square</span> <span class="keyword">implements</span> <span class="title">IShape</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Inside Square::draw() method."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ShapeFactory</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ä½¿ç”¨ getShape æ–¹æ³•è·å–å½¢çŠ¶ç±»å‹çš„å¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> IShape <span class="title">getShape</span><span class="params">(String shapeType)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (shapeType == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (shapeType.equalsIgnoreCase(<span class="string">"CIRCLE"</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Circle();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (shapeType.equalsIgnoreCase(<span class="string">"RECTANGLE"</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Rectangle();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (shapeType.equalsIgnoreCase(<span class="string">"SQUARE"</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Square();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Context</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ShapeFactory shapeFactory = <span class="keyword">new</span> ShapeFactory();</span><br><span class="line">        <span class="comment">//è·å– Circle çš„å¯¹è±¡ï¼Œå¹¶è°ƒç”¨å®ƒçš„ draw æ–¹æ³•</span></span><br><span class="line">        IShape shape1 = shapeFactory.getShape(<span class="string">"CIRCLE"</span>);</span><br><span class="line">        <span class="comment">//è°ƒç”¨ Circle çš„ draw æ–¹æ³•</span></span><br><span class="line">        shape1.draw();</span><br><span class="line">        <span class="comment">//è·å– Rectangle çš„å¯¹è±¡ï¼Œå¹¶è°ƒç”¨å®ƒçš„ draw æ–¹æ³•</span></span><br><span class="line">        IShape shape2 = shapeFactory.getShape(<span class="string">"RECTANGLE"</span>);</span><br><span class="line">        <span class="comment">//è°ƒç”¨ Rectangle çš„ draw æ–¹æ³•</span></span><br><span class="line">        shape2.draw();</span><br><span class="line">        <span class="comment">//è·å– Square çš„å¯¹è±¡ï¼Œå¹¶è°ƒç”¨å®ƒçš„ draw æ–¹æ³•</span></span><br><span class="line">        IShape shape3 = shapeFactory.getShape(<span class="string">"SQUARE"</span>);</span><br><span class="line">        <span class="comment">//è°ƒç”¨ Square çš„ draw æ–¹æ³•</span></span><br><span class="line">        shape3.draw();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Output:</p>
<p>Inside Circle::draw() method.<br>Inside Rectangle::draw() method.<br>Inside Square::draw() method.</p>
</blockquote>
<h3 id="å…³é”®è¯ï¼š"><a href="#å…³é”®è¯ï¼š" class="headerlink" title="å…³é”®è¯ï¼š"></a>å…³é”®è¯ï¼š</h3><p><em>complex creation logic, separate the creation responsibilities for better cohesion</em></p>
<h3 id="æ€»ç»“-1"><a href="#æ€»ç»“-1" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ol>
<li>ç®€å•å·¥å‚æ¨¡å¼(Simple Factory) æ˜¯å¯¹GoFä¸­å·¥å‚æ¨¡å¼çš„ç®€åŒ–ï¼ŒäºŒè€…ä¸æ˜¯åŒä¸€æ¨¡å¼</li>
<li>å·¥å‚æ¨¡å¼éšè—äº†åˆ›å»ºç»†èŠ‚ï¼Œç‰¹åˆ«æ˜¯<strong>å¤æ‚çš„åˆ›å»º</strong>è¿‡ç¨‹</li>
</ol>
<h2 id="Singleton-å•ä¾‹æ¨¡å¼"><a href="#Singleton-å•ä¾‹æ¨¡å¼" class="headerlink" title="Singleton (å•ä¾‹æ¨¡å¼)"></a>Singleton (å•ä¾‹æ¨¡å¼)</h2><h3 id="ç±»å›¾ï¼š-1"><a href="#ç±»å›¾ï¼š-1" class="headerlink" title="ç±»å›¾ï¼š"></a>ç±»å›¾ï¼š</h3><p><img alt="Singleton Pattern Diagram" data-src="/11/è®¾è®¡æ¨¡å¼æ€»ç»“/singleton.png"></p>
<h3 id="ä»£ç ç¤ºä¾‹ï¼š-2"><a href="#ä»£ç ç¤ºä¾‹ï¼š-2" class="headerlink" title="ä»£ç ç¤ºä¾‹ï¼š"></a>ä»£ç ç¤ºä¾‹ï¼š</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä»¥ &#123;<span class="doctag">@link</span> ShapeFactory&#125; ä¸ºä¾‹</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonShapeFactory</span> <span class="keyword">extends</span> <span class="title">ShapeFactory</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * NOTEï¼š</span></span><br><span class="line"><span class="comment">     * è¯¥å˜é‡ä¸º private static</span></span><br><span class="line"><span class="comment">     * ç”¨äºå†…éƒ¨å®ä¾‹åŒ–è¯¥ç±»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> SingletonShapeFactory instance = <span class="keyword">new</span> SingletonShapeFactory();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * NOTEï¼š</span></span><br><span class="line"><span class="comment">     * æ„é€ å‡½æ•°è®¿é—®ç¬¦ä¸€å®šä¸º private</span></span><br><span class="line"><span class="comment">     * ç›®çš„æ˜¯é˜»æ­¢å¤–ç•Œè®¿é—®ï¼Œé˜»æ­¢å¤–ç•Œå®ä¾‹åŒ–</span></span><br><span class="line"><span class="comment">     * è¿™æ ·è¯¥ç±»åœ¨æ•´ä¸ªç¨‹åºä¸­åªæœ‰ä¸€ä¸ªå®ä¾‹åŒ–è¿‡çš„å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * å³ instance</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">SingletonShapeFactory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// do sth...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æä¾› static æ–¹æ³•ï¼Œä¸ºå¤–ç•Œæä¾›è®¿é—®å…¥å£</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å”¯ä¸€çš„ instance</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SingletonShapeFactory <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å•ä¾‹æ¨¡å¼çš„å˜ç§ä¹‹ä¸€</span></span><br><span class="line"><span class="comment">     * 1. Lazy initialization</span></span><br><span class="line"><span class="comment">     * instanceåˆå§‹å€¼ä¸º null</span></span><br><span class="line"><span class="comment">     * å³ instance åªåœ¨éœ€è¦æ—¶è¢«å®ä¾‹åŒ–</span></span><br><span class="line"><span class="comment">     * 2. ä½¿ç”¨ synchronized ä¿®é¥°</span></span><br><span class="line"><span class="comment">     * é˜²æ­¢å¤šçº¿ç¨‹å¹¶å‘è®¿é—®æ—¶é€ æˆå®ä¾‹åŒ–å¤šä¸ª instance</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> SingletonShapeFactory <span class="title">getInstance2</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (instance == <span class="keyword">null</span>)</span><br><span class="line">            instance = <span class="keyword">new</span> SingletonShapeFactory();</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å…³é”®è¯ï¼š-1"><a href="#å…³é”®è¯ï¼š-1" class="headerlink" title="å…³é”®è¯ï¼š"></a>å…³é”®è¯ï¼š</h3><p><em>one instance of a class is allowed, Objects need a global and single point of access</em></p>
<h3 id="æ€»ç»“-2"><a href="#æ€»ç»“-2" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p><strong>è¦ç‚¹ï¼š</strong></p>
<ol>
<li>private constructor</li>
<li>static instance and getter</li>
<li>åœ¨class diagramæˆ–sequence diagramä¸­ç±»åå³ä¸Šè§’æ ‡æ³¨1</li>
</ol>
<p><img alt="1541753510666" data-src="/11/è®¾è®¡æ¨¡å¼æ€»ç»“/1541753510666.png"></p>
<p><strong>æ€è€ƒï¼š</strong></p>
<ol>
<li>å¦‚æœ<code>getInstance()</code>æ–¹æ³•æ›¿æ¢ä¸ºä»¥ä¸‹ä»£ç è¡Œä¸è¡Œï¼›</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SingletonShapeFactory <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// åŒæ ·ä¿è¯äº†å¤–ç•Œæ— æ³• new å¦å¤–çš„å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> SingletonShapeFactory();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li><p>Why not arenâ€™t all Singleton service methods <code>static</code>?</p>
<p><code>static</code> æ–¹æ³•ä¸èƒ½è¢«<code>Override</code>ï¼Œä¸æ˜¯è™šæ–¹æ³•ï¼Œæ‰€ä»¥æ— æ³•å®ç°å¤šæ€(not polymorphic)</p>
</li>
</ol>
<h2 id="Strategy-ç­–ç•¥æ¨¡å¼"><a href="#Strategy-ç­–ç•¥æ¨¡å¼" class="headerlink" title="Strategy (ç­–ç•¥æ¨¡å¼)"></a>Strategy (ç­–ç•¥æ¨¡å¼)</h2><h3 id="ç±»å›¾ï¼š-2"><a href="#ç±»å›¾ï¼š-2" class="headerlink" title="ç±»å›¾ï¼š"></a>ç±»å›¾ï¼š</h3><p><img alt="Strategy Pattern Diagram" data-src="/11/è®¾è®¡æ¨¡å¼æ€»ç»“/1541821696843.png"></p>
<h3 id="æ€»ç»“-3"><a href="#æ€»ç»“-3" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p><strong>è¦ç‚¹ï¼š</strong></p>
<ol>
<li><p>ä½¿ç”¨å“ªç§ç­–ç•¥çš„åˆ¤æ–­æ¡ä»¶ä¸å°½ç›¸åŒï¼Œè‡ªå®šä¹‰</p>
<ol>
<li><p>å³ï¼ŒLecture Noteä¸­å°† Context Object <code>Sale</code>ä½œä¸ºå‚æ•°ä¼ å…¥<code>ISalePricingStrategy</code>ä¸­ä¸æ˜¯<strong>å”¯ä¸€/å¿…é¡»</strong>çš„</p>
<p><img alt="1541754654574" data-src="/11/è®¾è®¡æ¨¡å¼æ€»ç»“/1541754654574.png"></p>
</li>
</ol>
</li>
<li><p>æ‰§è¡Œç­–ç•¥æ¨¡å¼çš„æ–¹æ³•ä¸€èˆ¬æ˜¯å°†ç­–ç•¥æ¥å£ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">executeStrategy</span><span class="params">(IStrategy stragtegy, <span class="keyword">int</span> num1, <span class="keyword">int</span> num2,...)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> strategy.doOperation(num1, num2,...);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç­–ç•¥æ¨¡å¼è§†ä¸åŒæƒ…å†µæ‰§è¡Œä¸åŒç­–ç•¥ï¼Œè€Œä¸æ˜¯ <em>åŒæ—¶</em> æ‰§è¡Œ <em>æ‰€æœ‰</em> ç­–ç•¥ï¼Œæ‰€ä»¥ä¸ä¸€å®šè¦æœ‰ ifâ€¦elseâ€¦æˆ–switchâ€¦caseâ€¦</p>
</li>
</ol>
<h2 id="Composite-ç»„åˆæ¨¡å¼"><a href="#Composite-ç»„åˆæ¨¡å¼" class="headerlink" title="Composite (ç»„åˆæ¨¡å¼)"></a>Composite (ç»„åˆæ¨¡å¼)</h2><h3 id="ç±»å›¾ï¼š-3"><a href="#ç±»å›¾ï¼š-3" class="headerlink" title="ç±»å›¾ï¼š"></a>ç±»å›¾ï¼š</h3><p><img alt="Composite Pattern Diagram" data-src="/11/è®¾è®¡æ¨¡å¼æ€»ç»“/1541823472361.png"></p>
<h3 id="ä»£ç ç¤ºä¾‹ï¼š-3"><a href="#ä»£ç ç¤ºä¾‹ï¼š-3" class="headerlink" title="ä»£ç ç¤ºä¾‹ï¼š"></a>ä»£ç ç¤ºä¾‹ï¼š</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Pricing Strategy æ¥å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ISalePricingStrategy</span> </span>&#123;</span><br><span class="line">    <span class="function">Money <span class="title">getTotal</span><span class="params">(SaleContext saleContext)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ™®é€šç­–ç•¥</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AbsoluteDiscountOverThresholdPricingStrategy</span> <span class="keyword">implements</span> <span class="title">ISalePricingStrategy</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Money discount, threshold;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AbsoluteDiscountOverThresholdPricingStrategy</span><span class="params">(Money discount, Money threshold)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.discount = discount;</span><br><span class="line">        <span class="keyword">this</span>.threshold = threshold;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Money <span class="title">getTotal</span><span class="params">(SaleContext saleContext)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Money(discount.yuan * <span class="number">0.01</span> + threshold.yuan);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ™®é€šç­–ç•¥</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PercentageDiscountPricingStrategy</span> <span class="keyword">implements</span> <span class="title">ISalePricingStrategy</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> percentage;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PercentageDiscountPricingStrategy</span><span class="params">(<span class="keyword">double</span> percentage)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.percentage = percentage;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Money <span class="title">getTotal</span><span class="params">(SaleContext saleContext)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Money(saleContext.getPreDiscountTotal() * percentage);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç­–ç•¥æ¨¡å¼ + ç»„åˆæ¨¡å¼ (abstract class)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">CompositePricingStrategy</span> <span class="keyword">implements</span> <span class="title">ISalePricingStrategy</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> List&lt;ISalePricingStrategy&gt; pricingStrategies = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(ISalePricingStrategy strategy)</span> </span>&#123;</span><br><span class="line">        pricingStrategies.add(strategy);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> Money <span class="title">getTotal</span><span class="params">(SaleContext saleContext)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¦‚æœè¦æ±‚å†™ä»£ç </span></span><br><span class="line"><span class="comment"> * æ³¨æ„ interface ç”¨ implements //ç¬¬ä¸‰äººç§°</span></span><br><span class="line"><span class="comment"> *      abstract class ç”¨ extends //ç¬¬ä¸‰äººç§°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CompositeBestForCustomerPricingStrategy</span> <span class="keyword">extends</span> <span class="title">CompositePricingStrategy</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Money <span class="title">getTotal</span><span class="params">(SaleContext saleContext)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> lowestTotal = Double.MAX_VALUE;</span><br><span class="line">        <span class="keyword">for</span> (ISalePricingStrategy strategy : pricingStrategies) &#123;</span><br><span class="line">            <span class="keyword">double</span> total = strategy.getTotal(saleContext).yuan;</span><br><span class="line">            lowestTotal = Math.min(total, lowestTotal);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Money(lowestTotal);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CompositeBestForStorePricingStrategy</span> <span class="keyword">extends</span> <span class="title">CompositePricingStrategy</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Money <span class="title">getTotal</span><span class="params">(SaleContext saleContext)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//<span class="doctag">TODO:</span> do sth...</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å…³é”®è¯ï¼š-2"><a href="#å…³é”®è¯ï¼š-2" class="headerlink" title="å…³é”®è¯ï¼š"></a>å…³é”®è¯ï¼š</h3><p><em>group or composition</em></p>
<h3 id="æ€»ç»“-4"><a href="#æ€»ç»“-4" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p><img alt="1541760163905" data-src="/11/è®¾è®¡æ¨¡å¼æ€»ç»“/1541760163905.png"></p>
<p><strong>è¦ç‚¹ï¼š</strong></p>
<ol>
<li><code>CompositePricingStrategy</code> å¯ä»¥æ˜¯å…·ä½“ç±»ï¼Œä¹Ÿå¯ä»¥æ˜¯æŠ½è±¡ç±» (abstract class)</li>
<li><code>Composite</code> classå¯ä»¥åŒ…å«ä»»æ„å®ç° <code>Component</code> æ¥å£çš„ç±»ï¼ŒåŒ…æ‹¬è‡ªå·±</li>
<li>åœ¨ <code>Composite</code> çš„ <code>operation()</code> ä¸­å¯ä»¥ <code>for...each</code> æ‰§è¡Œæ‰€æœ‰å­ç±» <code>operation()</code>ï¼Œä¹Ÿå¯ä»¥ç­›é€‰ç‰¹å®šæ‰§è¡Œ<ol>
<li>åœ¨ <code>Composite</code> + <code>Strategy</code> çš„æ¨¡å¼ä¸­ï¼Œè°¨é˜²å°† <code>CompositeStrategy</code> å†™æˆ <code>Context</code> ï¼ŒåŒºåˆ«åœ¨äº <code>CompositeStrategy</code> å¯ç»„åˆ<strong>éƒ¨åˆ†</strong>ä¹Ÿå¯ä»¥ç»„åˆ<strong>å…¨éƒ¨</strong>ç­–ç•¥ï¼Œè€Œ <code>Context</code> å¿…é¡»<strong>é€‚ç”¨å…¨éƒ¨</strong>ç­–ç•¥</li>
</ol>
</li>
</ol>
<h2 id="Facade-å¤–è§‚æ¨¡å¼"><a href="#Facade-å¤–è§‚æ¨¡å¼" class="headerlink" title="FaÃ§ade (å¤–è§‚æ¨¡å¼)"></a>FaÃ§ade (å¤–è§‚æ¨¡å¼)</h2><h3 id="ç±»å›¾ï¼š-4"><a href="#ç±»å›¾ï¼š-4" class="headerlink" title="ç±»å›¾ï¼š"></a>ç±»å›¾ï¼š</h3><p><img alt="Facade Pattern Diagram" data-src="https://design-patterns.readthedocs.io/zh_CN/latest/_images/Facade.jpg"></p>
<h3 id="ä»£ç ç¤ºä¾‹ï¼š-4"><a href="#ä»£ç ç¤ºä¾‹ï¼š-4" class="headerlink" title="ä»£ç ç¤ºä¾‹ï¼š"></a>ä»£ç ç¤ºä¾‹ï¼š</h3><p><strong>Subsystemä»£ç ï¼š</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CPU</span> </span>&#123;   </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startup</span><span class="params">()</span></span>&#123;  </span><br><span class="line">        System.out.println(<span class="string">"cpu startup!"</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">shutdown</span><span class="params">()</span></span>&#123;  </span><br><span class="line">        System.out.println(<span class="string">"cpu shutdown!"</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Memory</span> </span>&#123;    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startup</span><span class="params">()</span></span>&#123;  </span><br><span class="line">        System.out.println(<span class="string">"memory startup!"</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">turnoff</span><span class="params">()</span></span>&#123;  </span><br><span class="line">        System.out.println(<span class="string">"memory shutdown!"</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125; </span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Disk</span> </span>&#123;  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startup</span><span class="params">()</span></span>&#123;  </span><br><span class="line">        System.out.println(<span class="string">"disk startup!"</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">poweroff</span><span class="params">()</span></span>&#123;  </span><br><span class="line">        System.out.println(<span class="string">"disk shutdown!"</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Facade ä»£ç ï¼š</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Computer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> CPU cpu;</span><br><span class="line">    <span class="keyword">private</span> Memory memory;</span><br><span class="line">    <span class="keyword">private</span> Disk disk;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Computer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        cpu = <span class="keyword">new</span> CPU();</span><br><span class="line">        memory = <span class="keyword">new</span> Memory();</span><br><span class="line">        disk = <span class="keyword">new</span> Disk();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"start the computer!"</span>);</span><br><span class="line">        cpu.startup();</span><br><span class="line">        memory.startup();</span><br><span class="line">        disk.startup();</span><br><span class="line">        System.out.println(<span class="string">"start computer finished!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">shutdown</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"begin to close the computer!"</span>);</span><br><span class="line">        cpu.shutdown();</span><br><span class="line">        memory.turnoff();</span><br><span class="line">        disk.poweroff();</span><br><span class="line">        System.out.println(<span class="string">"computer closed!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å…³é”®è¯ï¼š-3"><a href="#å…³é”®è¯ï¼š-3" class="headerlink" title="å…³é”®è¯ï¼š"></a>å…³é”®è¯ï¼š</h3><p><em>common, unified interface, subsystem</em></p>
<h3 id="æ€»ç»“-5"><a href="#æ€»ç»“-5" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>è¦ç‚¹ï¼š</p>
<ol>
<li><p>æ¥å£ä¸æ˜¯å¿…éœ€ï¼Œå› ä¸ºä¸èƒ½è¦æ±‚subsystemä¸­æ–¹æ³•ç­¾åéƒ½å¿…é¡»ç›¸åŒ</p>
<p>å¦‚ï¼š<code>shutdown()</code> / <code>turnoff()</code> / <code>poweroff()</code></p>
</li>
<li><p>è¯¥æ¨¡å¼åº”ç”¨äºå°†å¤æ‚çš„ç³»ç»Ÿæ‰§è¡Œç®€åŒ–ã€éšè—ç»†èŠ‚</p>
</li>
</ol>
<h2 id="Observer-aka-Publish-Subscribe-è§‚å¯Ÿè€…æ¨¡å¼"><a href="#Observer-aka-Publish-Subscribe-è§‚å¯Ÿè€…æ¨¡å¼" class="headerlink" title="Observer (aka Publish-Subscribe) (è§‚å¯Ÿè€…æ¨¡å¼)"></a>Observer (aka Publish-Subscribe) (è§‚å¯Ÿè€…æ¨¡å¼)</h2><h3 id="ç±»å›¾ï¼š-5"><a href="#ç±»å›¾ï¼š-5" class="headerlink" title="ç±»å›¾ï¼š"></a>ç±»å›¾ï¼š</h3><p><img alt="Observer Pattern Diagram" data-src="/11/è®¾è®¡æ¨¡å¼æ€»ç»“/1541824090370.png"></p>
<h3 id="å…³é”®è¯ï¼š-4"><a href="#å…³é”®è¯ï¼š-4" class="headerlink" title="å…³é”®è¯ï¼š"></a>å…³é”®è¯ï¼š</h3><p><em>subscriber or listener</em></p>
<h3 id="æ€»ç»“-6"><a href="#æ€»ç»“-6" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>f<em>r</em>e<em>e</em>s<strong>t</strong>y<em>l</em>e</p>
]]></content>
      <categories>
        <category>Programming</category>
      </categories>
      <tags>
        <tag>Design Patterns</tag>
      </tags>
  </entry>
  <entry>
    <title>Immutableå’ŒMutable Objects in Java</title>
    <url>/11/Immutable%E5%92%8CMutable-Objects-in-Java/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬æ–‡ä¸»è¦é˜è¿°ä»¥ä¸‹è§‚ç‚¹ï¼š</p>
<ol>
<li>å€¼ç±»å‹ä¸å¼•ç”¨ç±»å‹çš„å®šä¹‰ä¸åŒºåˆ«ï¼›</li>
<li>ä¸å¯å˜å¯¹è±¡ä¸å¯å˜å¯¹è±¡çš„å®šä¹‰ä¸åŒºåˆ«ï¼›</li>
<li>ä¸å¯å˜å¯¹è±¡çš„ä¼˜ç‚¹ä¸ç¼ºç‚¹ï¼›</li>
<li>Stringç±»ä¸ºä»€ä¹ˆæ˜¯ä¸å¯å˜çš„ï¼›</li>
<li>æ€æ ·å£°æ˜ä¸å¯å˜å¯¹è±¡ï¼ˆåŒ…æ‹¬å˜é‡å’Œç±»ï¼‰ï¼›</li>
</ol>
<a id="more"></a>
<h2 id="æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="æ˜¯ä»€ä¹ˆï¼Ÿ"></a>æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>åœ¨äº†è§£ä¸å¯å˜å¯¹è±¡ï¼ˆImmutable Objectsï¼‰åŠå¯å˜å¯¹è±¡ï¼ˆMutable Objectsï¼‰ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“å†…å­˜ä¸­ä¸¤ç§æ•°æ®ç±»å‹ï¼šå€¼ç±»å‹ï¼ˆvalue typesï¼‰å’Œå¼•ç”¨ç±»å‹ï¼ˆreference typesï¼‰â€”â€”</p>
<p><strong>å€¼ç±»å‹</strong>æ•°æ®å­˜æ”¾åœ¨<strong>æ ˆï¼ˆstackï¼‰</strong>å†…ï¼Œå…¶å€¼ä»£è¡¨æ•°æ®æœ¬èº«ï¼Œå­˜å‚¨åœ¨æ ˆä¸­åˆ†é…çš„å†…å­˜ç©ºé—´ã€‚</p>
<p><strong>å¼•ç”¨ç±»å‹</strong>æ•°æ®å­˜æ”¾åœ¨<strong>å †ï¼ˆheapï¼‰</strong>å†…ï¼Œå…¶å€¼ä»£è¡¨çš„æ˜¯æ‰€æŒ‡å‘çš„<strong>åœ°å€</strong>ï¼Œ<strong>æŒ‡å‘</strong>æ‰€è¦å­˜å‚¨çš„å€¼è€Œä¸ç›´æ¥å­˜å‚¨ã€‚</p>
<p>ä¾‹å¦‚ï¼šå‡è®¾Personæ˜¯ä¸€ç§<strong>å€¼</strong>ç±»å‹ï¼ŒHouseæ˜¯ä¸€ç§<strong>å¼•ç”¨</strong>ç±»å‹ï¼Œæœ‰ä»¥ä¸‹å˜é‡ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Person è€ç‹ = <span class="keyword">new</span> Person(); <span class="comment">//Person æ˜¯å€¼ç±»å‹</span></span><br><span class="line">Person å°ç‹ = è€ç‹ï¼›			<span class="comment">//å°ç‹æ˜¯è€ç‹â€œå…‹éš†â€å‡ºæ¥çš„ï¼Œä¸€æ¨¡ä¸€æ ·ï¼›</span></span><br><span class="line">House è€ç‹çš„å®¶ = <span class="keyword">new</span> House();<span class="comment">//House æ˜¯å¼•ç”¨ç±»å‹</span></span><br><span class="line">House å°ç‹çš„å®¶ = è€ç‹çš„å®¶ï¼›	 <span class="comment">//å°ç‹å’Œè€ç‹ä½åœ¨åŒä¸€ä¸ªå®¶é‡Œï¼›</span></span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆåŸºäºæ­¤ï¼Œå‡å¦‚æœ‰ä¸€å¤©è€ç‹å› æŸäº‹è´¥éœ²è€Œè¢«æ‰“æ®‹ï¼Œå°ç‹çš„å®‰å±å¹¶ä¸ä¼šå—æ­¤å½±å“ï¼Œå³ä½¿ä»–ä»¬æœ‰ç›¸åŒçš„æ ·è²Œï¼Œå› ä¸ºä»–ä»¬æ˜¯ç›¸äº’ç‹¬ç«‹çš„ä¸ªä½“ï¼›è€Œè€ç‹å®¶é‡Œç½®åŠäº†æ–°çš„ç”µè§†æˆ–æƒ¨é­æ´—åŠ«ï¼Œâ€œå°ç‹çš„å®¶â€è‡ªç„¶ä¹Ÿä¼šæ¥å—ç›¸åŒçš„æ”¹å˜ï¼Œå› ä¸ºä»–ä»¬å®¶çš„åœ°å€æŒ‡å‘äº†åŒä¸€æ¡è¡—é“çš„åŒä¸€ä¸ªæˆ¿é—´ã€‚</p>
<p>åœ¨Javaä¸­ï¼Œåªæœ‰åŸºæœ¬ç±»å‹ï¼ˆPrimitive Data Typesï¼‰ï¼ˆå³<code>byte</code>, <code>short</code>, <code>int</code>, <code>long</code>, <code>float</code>, <code>double</code>, <code>char</code>, <code>boolean</code>ï¼‰æ˜¯å€¼ç±»å‹ï¼Œå…¶ä»–çš„æ•°æ®ç±»å‹éƒ½æ˜¯å¼•ç”¨ç±»å‹ï¼ŒåŒ…æ‹¬<code>String</code>ï¼Œå³å¯¹è±¡ï¼ˆ<code>Objects</code>ï¼‰.</p>
<p>è€Œå¼•ç”¨ç±»å‹åˆåˆ†ä¸ºä¸å¯å˜å¯¹è±¡ï¼ˆImmutable Objectsï¼‰å’Œå¯å˜å¯¹è±¡ï¼ˆMutable Objectsï¼‰ï¼Œå¯å˜å¯¹è±¡å³ä¸ºä¸Šè¿°æåˆ°çš„æ™®é€šå¼•ç”¨ç±»å‹æ•°æ®ï¼Œå¦‚æœä¸¤ä¸ªå˜é‡æŒ‡å‘åŒä¸€åœ°å€æ—¶ï¼Œå…¶ä¸­ä¸€ä¸ªçš„å€¼æ”¹å˜äº†å¦ä¸€ä¸ªå€¼ä¹ŸåŒæ ·æ”¹å˜ï¼Œä¸‹é¢è¯¦ç»†è¯´ä¸€ä¸‹å¯¹ä¸å¯å˜å¯¹è±¡çš„ç†è§£ã€‚</p>
<h3 id="Immutable-Objects"><a href="#Immutable-Objects" class="headerlink" title="Immutable Objects"></a>Immutable Objects</h3><blockquote>
<p>An object is considered <em>immutable</em> if its state cannot change after it is constructed.<sup><a href="#fn_1" id="reffn_1">1</a></sup></p>
</blockquote>
<p>å³ï¼šä¸å¯å˜å¯¹è±¡åœ¨æ„é€ ï¼ˆå£°æ˜å¹¶ä¸”åˆå§‹åŒ–åï¼‰ä¹‹åï¼Œå…¶<strong>çŠ¶æ€</strong>ä¸å¯å†æ”¹å˜ã€‚å…¶ä¸­<code>String</code>ç±»å’ŒåŸºæœ¬ç±»å‹çš„Wrapper Class ï¼ˆ<code>Integer</code>, <code>Double</code>, etc.ï¼‰å±äºå…¸å‹çš„ä¸å¯å˜ç±»ã€‚è¿™é‡Œéœ€è¦æ³¨æ„ï¼š<u>çŠ¶æ€ä¸å¯å˜</u>æ˜¯æŒ‡å¯¹è±¡å®ä¾‹çš„<strong>å€¼</strong>ä¸å¯å˜è€Œä¸æ˜¯æŒ‡å‘è¯¥å®ä¾‹çš„<strong>å¼•ç”¨</strong>çš„ä¸å¯å˜ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String king= <span class="string">"John Snow"</span>;</span><br><span class="line">king = <span class="string">"others"</span>;</span><br></pre></td></tr></table></figure>
<p>ä¸Šè¿°æ‰€ç¤ºå¥½åƒ<code>String</code> çš„å€¼å‘ç”Ÿäº†æ”¹å˜ï¼Œ<del>è¯´å¥½çš„String ä¸€ç”Ÿä¸å˜åˆ°ç™½å¤´ï¼Œå®ƒå´å·å·ç„—äº†æ²¹</del>ï¼›å…¶å®ï¼Œæ­¤å¤„çš„ä¸å¯å˜æ˜¯æŒ‡â€John Snowâ€è¿™ä¸ªå†…å­˜ä¸­çš„å€¼æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œåªæ˜¯<code>king</code>ä¸å†<strong>æŒ‡å‘</strong>å®ƒäº†ï¼Œè€Œæ¢æˆäº†â€othersâ€ï¼Œé‚£ä¹ˆâ€John Snowâ€å»å“ªå„¿äº†ï¼Ÿ<del>é•¿åŸä¹‹å¤–è¿˜æ˜¯é¾™å¦ˆé—ºæˆ¿ï¼Ÿ</del>å¾ˆå¯æƒœï¼Œéƒ½ä¸æ˜¯ï¼Œä»–è¢«ç•™åœ¨äº†å†…å­˜é‡Œï¼Œç­‰å¾…GCï¼ˆGarbage Collectionï¼Œåƒåœ¾æ”¶é›†ï¼Œåƒåœ¾å›æ”¶ï¼‰æ¥å›æ”¶ä»–ã€‚</p>
<p>é‚£è¿™æ ·åšæœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿç™½ç™½åˆ¶é€ å‡ºäº†å†…å­˜åƒåœ¾ï¼Œkingåˆ°å¤´æ¥è¿˜æ˜¯æ˜“ä¸»äº†ï¼Ÿ</p>
<h2 id="ä¸ºä»€ä¹ˆï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆï¼Ÿ"></a>ä¸ºä»€ä¹ˆï¼Ÿ</h2><p>é¦–å…ˆï¼Œæˆ‘ä»¬çŸ¥é“<code>String</code>æ˜¯ä¸å¯å˜ç±»ï¼Œè€Œ<code>StringBuilder</code>æ˜¯å¯å˜çš„ï¼Œæ‰€ä»¥å…ˆçœ‹ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span> </span>&#123;</span><br><span class="line">    String John = <span class="string">"John"</span>;</span><br><span class="line">    StringBuilder John2 = <span class="keyword">new</span> StringBuilder(<span class="string">"John"</span>);</span><br><span class="line">    System.out.println(<span class="string">"What's your name?\t"</span> + John);</span><br><span class="line">    System.out.println(<span class="string">"Your full name please.\t"</span> + getFullName(John));</span><br><span class="line">    System.out.println(<span class="string">"What's your first name?\t"</span> + John);</span><br><span class="line">    System.out.println();</span><br><span class="line">    System.out.println(<span class="string">"What's your name?\t"</span> + John2);</span><br><span class="line">    System.out.println(<span class="string">"Your full name please.\t"</span> + getFullName(John2));</span><br><span class="line">    System.out.println(<span class="string">"What's your first name?\t"</span> + John2);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">getFullName</span><span class="params">(String fstName)</span> </span>&#123;</span><br><span class="line">    fstName += <span class="string">" Snow"</span>;</span><br><span class="line">    <span class="keyword">return</span> fstName;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> StringBuilder <span class="title">getFullName</span><span class="params">(StringBuilder fstName)</span> </span>&#123;</span><br><span class="line">    fstName.append(<span class="string">" Snow"</span>);</span><br><span class="line">    <span class="keyword">return</span> fstName;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// What's your name?	John</span></span><br><span class="line"><span class="comment">// Your full name please.	John Snow</span></span><br><span class="line"><span class="comment">// What's your first name?	John			//Value has NOT changed.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// What's your name?	John</span></span><br><span class="line"><span class="comment">// Your full name please.	John Snow</span></span><br><span class="line"><span class="comment">// What's your first name?	John Snow		//Value has changed.</span></span><br></pre></td></tr></table></figure>
<p>ä¸Šè¿°æ‰€ç¤ºï¼Œå¯å˜ç±»<code>StringBuilder</code>çš„å€¼æ”¹å˜äº†ï¼Œè€Œè¿™å¸¸å¸¸ä¸æ˜¯ç¨‹åºå‘˜æƒ³è¦æˆ–ä¸»åŠ¨è¦åšçš„ï¼Œæ‰€ä»¥ä¸å¯å˜ç±»çš„ä¸€å¤§ä¼˜ç‚¹æ˜¯ä¿è¯äº†<strong>çº¿ç¨‹å®‰å…¨ï¼Œä¸ä¼šå‡ºç°åŒæ­¥é—®é¢˜å’Œéšç§æ³„æ¼ï¼ˆPrivacy Leaksï¼‰</strong>ã€‚å½“ç„¶ï¼Œè¿™ç§éšæ‚£è¿˜å¯ä»¥é€šè¿‡ä¿æŠ¤æ€§æ‹·è´ï¼ˆDefensive Copyï¼‰æˆ–æ·±åº¦å¤åˆ¶ï¼ˆDeep Copyï¼‰æ¥è§„é¿ï¼Œä¸å¯å˜ç±»åŒæ ·å¯é ï¼Œä½†ä»£ç ç®€å•ã€‚</p>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œä¸å¯å˜ç±»è¿˜<strong>æé«˜äº†æ‹·è´çš„æ•ˆç‡</strong>ï¼Œå› ä¸ºå¤åˆ¶æ—¶ä¸å†éœ€è¦å¤åˆ¶è¯¥å¯¹è±¡çš„å€¼ï¼Œåªéœ€è¦å¤åˆ¶å…¶åœ°å€ï¼ˆæŒ‡é’ˆï¼‰å³å¯ï¼Œè€Œè¿™åªéœ€è¦å¾ˆå°çš„å†…å­˜ç©ºé—´ï¼ŒåŒæ—¶ï¼Œå¯¹å…¶ä»–å¼•ç”¨è¯¥å¯¹è±¡çš„å˜é‡ä¸é€ æˆå½±å“ã€‚<sup><a href="#fn_2" id="reffn_2">2</a></sup></p>
<p>ç”±å¼€å§‹æ—¶â€John Snowâ€è¢«â€œé›ªè—â€çš„ä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œè¿‡å¤šçš„ä¸å¯å˜ç±»ä¼šé€ æˆå¾ˆå¤šå†…å­˜åƒåœ¾ï¼Œä¸€å®šç¨‹åº¦ä¸Šå¢åŠ äº†ç¨‹åºçš„è¿è¡Œæˆæœ¬ï¼Œä½†ä¹Ÿæœ‰ä¸åŒçœ‹æ³•è®¤ä¸ºï¼š</p>
<blockquote>
<p>ç¨‹åºå‘˜å¾€å¾€ä¸æ„¿ä½¿ç”¨ä¸å¯å˜å¯¹è±¡ï¼Œå› ä¸ºä»–ä»¬æ‹…å¿ƒåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡è¦æ¯”æ›´æ–°å¯¹è±¡çš„æˆæœ¬è¦é«˜ã€‚å®é™…ä¸Šè¿™ç§å¼€é”€å¸¸å¸¸è¢«è¿‡åˆ†é«˜ä¼°ï¼Œè€Œä¸”ä½¿ç”¨ä¸å¯å˜å¯¹è±¡æ‰€å¸¦æ¥çš„ä¸€äº›æ•ˆç‡æå‡ä¹ŸæŠµæ¶ˆäº†è¿™ç§å¼€é”€ã€‚ä¾‹å¦‚ï¼šä½¿ç”¨ä¸å¯å˜å¯¹è±¡é™ä½äº†åƒåœ¾å›æ”¶æ‰€äº§ç”Ÿçš„é¢å¤–å¼€é”€ï¼Œä¹Ÿå‡å°‘äº†ç”¨æ¥ç¡®ä¿ä½¿ç”¨å¯å˜å¯¹è±¡ä¸å‡ºç°å¹¶å‘é”™è¯¯çš„ä¸€äº›é¢å¤–ä»£ç ã€‚<sup><a href="#fn_3" id="reffn_3">3</a></sup></p>
</blockquote>
<p>æ‰€ä»¥ä¸€èˆ¬æ›´å¤šåœ°å»ºè®®åœ¨ä»£ç ä¸­åˆç†è¿ç”¨ä¸å¯å˜ç±»ã€‚</p>
<h2 id="æ€ä¹ˆåšï¼Ÿ"><a href="#æ€ä¹ˆåšï¼Ÿ" class="headerlink" title="æ€ä¹ˆåšï¼Ÿ"></a>æ€ä¹ˆåšï¼Ÿ</h2><p>å±€éƒ¨å˜é‡ã€æˆå‘˜å˜é‡å’Œç±»éƒ½å¯ä»¥å£°æ˜ä¸ºä¸å¯å˜å¯¹è±¡ã€‚å±€éƒ¨å˜é‡ã€æˆå“å˜é‡æ“ä½œè¾ƒä¸ºç®€å•ï¼Œå½’ä¸ºä¸€ç±»ï¼Œä¸å¯å˜ç±»å•è¯´ã€‚</p>
<h3 id="ä¸å¯å˜å˜é‡"><a href="#ä¸å¯å˜å˜é‡" class="headerlink" title="ä¸å¯å˜å˜é‡"></a>ä¸å¯å˜å˜é‡</h3><p>å½¢å¼ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">(vis) <span class="keyword">final</span> type <span class="keyword">var</span> = value;</span><br></pre></td></tr></table></figure>
<p>ä¾‹å¦‚ï¼š</p>
<p>å±€éƒ¨å˜é‡ï¼š<code>final String king = &quot;John Snow&quot;;</code></p>
<p>æˆå‘˜å˜é‡ï¼š<code>private final String king = &quot;John Snow&quot;;</code></p>
<p>ç‰¹æ®Šåœ°ï¼Œå¸¸é‡ä»¥ä»¥ä¸‹å½¢å¼å£°æ˜ï¼š</p>
<p><code>public static final String KING = &quot;John Snow&quot;;</code></p>
<p>ç‰¹åˆ«éœ€è¦æ³¨æ„æ•°ç»„ï¼ˆArrayï¼‰ç­‰ç±»å‹çš„ä¸å¯å˜æ€§ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">final</span> String[] week = <span class="keyword">new</span> String[]&#123;<span class="string">"Sunday"</span>, <span class="string">"Monday"</span>, <span class="string">"Tuesday"</span>, <span class="string">"Wednesday"</span>...&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Week = new String[]&#123;"Sunday", "Sunday", "Sunday", "Sunday"...&#125;;    //invalid</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; week.length; i++) &#123;</span><br><span class="line">	week[i] = <span class="string">"Sunday"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">System.out.println(Arrays.toString(week));</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//[Sunday, Sunday, Sunday, Sunday, Sunday, Sunday, Sunday]</span></span><br></pre></td></tr></table></figure>
<p>ä¸Šè¿°ä»£ç ä¸­ï¼Œå°†æ•°ç»„å˜é‡weekç½®ä¸ºä¸å¯å˜ï¼Œé‚£ä¹ˆå½“æˆ‘ä»¬è¦å°†ä¸€å‘¨çš„æ¯ä¸€å¤©éƒ½èµ‹å€¼ä¸ºæ˜ŸæœŸå¤©æ—¶ï¼Œå®ƒå¦‚çº¦æç¤ºâ€Cannot assign a value to final variableâ€ è®©æˆ‘ä»¬æ–­äº†å¿µæƒ³ï¼Œä½†è½¬èº«ä¸€ä¸ªfor å¾ªç¯å°±å®ç°äº†ï¼Œåœ¨ä½¿ç”¨ä¸­è¦æ³¨æ„è¿™ç§æƒ…å†µã€‚</p>
<h3 id="ä¸å¯å˜ç±»"><a href="#ä¸å¯å˜ç±»" class="headerlink" title="ä¸å¯å˜ç±»"></a>ä¸å¯å˜ç±»</h3><p>ä¸å¯å˜ç±»çš„å£°æ˜è¦éº»çƒ¦å¾ˆå¤šï¼Œä¸å•å•æ˜¯å£°æ˜ä¸ºâ€finalâ€å°±å¯ä»¥çš„ï¼Œè€Œä¸”ï¼Œâ€finalâ€åœ¨ä¸å¯å˜ç±»ä¸­çš„ä½œç”¨æ˜¯<strong>ä½¿è¯¥ç±»ä¸å¯è¢«ç»§æ‰¿</strong>ï¼Œè€Œå’Œä½¿ä¹‹ä¸å¯å˜æ²¡æœ‰å¿…ç„¶è”ç³»ã€‚ä¸»è¦æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>ä¿è¯æ‰€æœ‰æˆå‘˜å˜é‡å¿…é¡»ç§æœ‰ï¼ˆ<code>private</code>ï¼‰ï¼Œå¹¶ä¸”ç”¨<code>final</code>ä¿®é¥°</li>
<li>ä¸æä¾›æ”¹å˜æˆå‘˜å˜é‡çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬<code>setter</code></li>
<li>é€šè¿‡æ„é€ å™¨åˆå§‹åŒ–æ‰€æœ‰æˆå‘˜ï¼Œè¿›è¡Œæ·±æ‹·è´(deep copy)ï¼Œç‰¹åˆ«æ˜¯å¯¹éåŸºæœ¬ç±»å‹çš„æˆå‘˜ï¼Œå³å¼•ç”¨ç±»å‹</li>
<li>ç±»æ·»åŠ <code>final</code>ä¿®é¥°ç¬¦ï¼Œä¿è¯ç±»ä¸è¢«ç»§æ‰¿</li>
</ol>
<p>çœ‹ä¸€ä¸‹Javaè‡ªå·±æºä»£ç ä¸­ä¸å¯å˜ç±»ï¼ˆ<code>String</code>ï¼‰æ˜¯å¦‚ä½•å®šä¹‰çš„ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">String</span></span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span>, <span class="title">Comparable</span>&lt;<span class="title">String</span>&gt;, <span class="title">CharSequence</span> </span>&#123;</span><br><span class="line">    <span class="comment">/** The value is used for character storage. */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">char</span> value[];</span><br><span class="line">    <span class="comment">/** Cache the hash code for the string */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> hash; <span class="comment">// Default to 0</span></span><br><span class="line">    ...</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<ol>
<li><p><code>String</code> ç±»ä¸­åŸºæœ¬ç¬¦åˆä»¥ä¸Šå£°æ˜çš„ä¸»è¦æ­¥éª¤ï¼›</p>
</li>
<li><p>å¯ä»¥çœ‹åˆ°<code>String</code>å…¶å®æ˜¯ç”¨<code>char[]</code>å­˜å‚¨æ•°æ®çš„ï¼Œä½†å®ƒæ˜¯<code>final</code> å¹¶ä¸”<code>private</code>çš„ï¼Œæ‰€ä»¥é¿å…äº†åƒ<code>week</code>æ•°ç»„é‚£æ ·è¢«æ”¹å†™çš„é£é™©ï¼›</p>
</li>
<li><p>æœ‰ä¸ªhashå˜é‡æ²¡æœ‰<code>final</code>ï¼Œè¿™é‡Œåˆ©ç”¨äº†å…¶ä»–çš„æœºåˆ¶æ¥ä¿è¯å…¶ä¸å¯å˜ï¼Œè¿™é‡Œä¸åšè§£é‡Šï¼Œå¯ä»¥å‚è€ƒï¼š</p>
<p><a href="https://www.zhihu.com/question/20618891/answer/15653033" target="_blank" rel="noopener">å¦‚ä½•ç†è§£Stringç±»å‹å€¼çš„ä¸å¯å˜ï¼Ÿ - Haltyçš„å›ç­” - çŸ¥ä¹</a></p>
</li>
</ol>
<p>Javaä¸­åŒæ ·æœ‰æ²¡æœ‰å°†ç±»å£°æ˜ä¸º<code>final</code>çš„ä¸å¯å˜ç±»ï¼ˆ<code>BigDecimal</code>å’Œ<code>BigInteger</code>ï¼‰ï¼Œå¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BigDecimal</span> <span class="keyword">extends</span> <span class="title">Number</span> <span class="keyword">implements</span> <span class="title">Comparable</span>&lt;<span class="title">BigDecimal</span>&gt; </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The unscaled value of this BigDecimal, as returned by &#123;<span class="doctag">@link</span></span></span><br><span class="line"><span class="comment">     * #unscaledValue&#125;.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@serial</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #unscaledValue</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> BigInteger intVal;</span><br></pre></td></tr></table></figure>
<p>ä½†åŒæ ·é‡‡å–äº†å…¶ä»–æœºåˆ¶æ¥ä¿è¯å…¶ä¸å¯å˜æ€§ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬æ–‡ç®€å•ä»‹ç»äº†Immutable Objectsï¼ˆä¸å¯å˜å¯¹è±¡ï¼‰å’ŒMutable Objectsï¼ˆå¯å˜å¯¹è±¡ï¼‰çš„ä¸€äº›ç‰¹ç‚¹ï¼Œåˆç†è¿ç”¨ä¸å¯å˜å¯¹è±¡ä¼šä½¿ä»£ç æ•´æ´è€Œé«˜æ•ˆï¼Œç‰¹åˆ«æ˜¯åœ¨äº‹ä»¶ã€å¤šçº¿ç¨‹ç­‰æ•°æ®å®‰å…¨æ€§è¦æ±‚é«˜çš„æƒ…æ™¯ä¸‹ï¼Œåœ¨å®è·µä¸­å¯ä»¥æ‘¸ç´¢å‡ºé€‚åˆè‡ªå·±çš„ä»£ç é£æ ¼ã€‚</p>
<hr>
<h2 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h2><blockquote id="fn_1">
<sup>1</sup>. <a href="https://docs.oracle.com/javase/tutorial/essential/concurrency/immutable.html" target="_blank" rel="noopener">https://docs.oracle.com/javase/tutorial/essential/concurrency/immutable.html</a><a href="#reffn_1" title="Jump back to footnote [1] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_2">
<sup>2</sup>. <a href="http://zhiheng.me/124#comment-195" target="_blank" rel="noopener">http://zhiheng.me/124#comment-195</a><a href="#reffn_2" title="Jump back to footnote [2] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_3">
<sup>3</sup>. <a href="https://waylau.gitbooks.io/essential-java/docs/concurrency-Immutable%20Objects.html#" target="_blank" rel="noopener">https://waylau.gitbooks.io/essential-java/docs/concurrency-Immutable%20Objects.html#</a><a href="#reffn_3" title="Jump back to footnote [3] in the text."> &#8617;</a>
</blockquote>
]]></content>
      <categories>
        <category>Programming</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Immutable</tag>
        <tag>Mutable</tag>
      </tags>
  </entry>
  <entry>
    <title>æµ…è°ˆJAVAæŠ½è±¡ç±»åŠæ¥å£</title>
    <url>/10/%E6%B5%85%E8%B0%88JAVA%E6%8A%BD%E8%B1%A1%E7%B1%BB%E5%8F%8A%E6%8E%A5%E5%8F%A3/</url>
    <content><![CDATA[<p>ä½œä¸ºé¢å‘å¯¹è±¡è¯­è¨€ï¼ŒJAVAåŒæ ·å…·æœ‰å°è£…ã€ç»§æ‰¿å’Œå¤šæ€çš„åŸºæœ¬ç‰¹å¾ï¼Œå…¶ä¸­æŠ½è±¡ç±»å’Œæ¥å£å¾ˆå¥½åœ°ä½“ç°äº†è¿™ä¸€ç‚¹ï¼Œå› ä¸ºç»“æ„ç›¸ä¼¼ä½†åˆæœ‰å®é™…çš„ä¸åŒï¼Œæ‰€ä»¥è¿™é‡Œæ”¾åœ¨ä¸€èµ·è¯´ã€‚</p>
<a id="more"></a>
<p>å‡å¦‚æˆ‘ä»¬è¦å†™ä¸€ä¸ªZooçš„projectï¼Œæœ‰å¤šç§åŠ¨ç‰©çš„ç±»<code>Dog</code>, <code>Cat</code>, <code>Parrot</code>ç­‰ï¼Œå®ƒä»¬éƒ½æœ‰<code>eat()</code>çš„æ–¹æ³•ï¼Œæˆ‘ä»¬ä¼šè‡ªç„¶æƒ³åˆ°å»ºé€ ä¸€ä¸ª<code>Animal</code>çš„ç±»ä½œä¸ºçˆ¶ç±»å­˜æ”¾è¿™äº›åŠ¨ç‰©å…±æœ‰çš„æ–¹æ³•åŠå±æ€§ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">(String food)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"I am eating "</span> + food);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dog</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">----------------------------------------------------</span><br><span class="line">  åº”ç”¨æ—¶ï¼š</span><br><span class="line">  Animal Snoopy=<span class="keyword">new</span> Dog();</span><br><span class="line">  Snoopy.eat(<span class="string">"Cookies"</span>);</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å‘ç°å³ä½¿ä¸ç”¨æŠ½è±¡ç±»ä¹Ÿå¯ä»¥å¾ˆå¥½åœ°å®Œæˆä»»åŠ¡ï¼Œé‚£ä¹ˆ<strong>ä¸ºä»€ä¹ˆè¦ç”¨æŠ½è±¡ç±»è€Œä¸ç”¨æ™®é€šç±»å‘¢ï¼Ÿ</strong></p>
<p>å…ˆä»<strong>æŠ½è±¡æ–¹æ³•</strong>è®²èµ·ï¼š</p>
<hr>
<h2 id="æŠ½è±¡æ–¹æ³•"><a href="#æŠ½è±¡æ–¹æ³•" class="headerlink" title="æŠ½è±¡æ–¹æ³•"></a>æŠ½è±¡æ–¹æ³•</h2><p>æŠ½è±¡æ–¹æ³•æŒ‡ç”¨â€œ<code>abstract</code>â€ ä¿®é¥°çš„æ–¹æ³•ï¼Œè¯¥æ–¹æ³•åªæœ‰å£°æ˜ï¼Œæ²¡æœ‰å®ç°çš„æ–¹æ³•ä½“ï¼Œå®ƒçš„å…·ä½“å®ç°äº¤ç»™å­ç±»æ¥ç¡®å®šï¼Œå¯ä»¥çœ‹å‡ºæŠ½è±¡æ–¹æ³•æ˜¯ç”Ÿè€Œä¸ºâ€œç»§æ‰¿â€çš„ï¼Œä¾‹å¦‚åœ¨<code>Animal</code>ä¸­åªæŒ‡å®š<code>eat()</code>æ–¹æ³•ï¼Œå…·ä½“æ€ä¹ˆåƒè®©å°ç‹—å°çŒ«å»å†³å®šï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">(String food)</span></span>;</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨æŠ½è±¡æ–¹æ³•æœ‰ä¸‰ç‚¹è¦æ±‚ï¼š</p>
<ul>
<li>å¦‚æœä¸€ä¸ªç±»åŒ…å«æŠ½è±¡æ–¹æ³•ï¼Œé‚£ä¹ˆè¯¥ç±»<strong>å¿…é¡»</strong>æ˜¯æŠ½è±¡ç±»ã€‚</li>
<li>ä»»ä½•å­ç±»<strong>å¿…é¡»</strong>é‡å†™çˆ¶ç±»çš„æŠ½è±¡æ–¹æ³•ï¼Œ<strong>æˆ–è€…å£°æ˜è‡ªèº«ä¸ºæŠ½è±¡ç±»</strong>ã€‚</li>
<li><strong>æ„é€ æ–¹æ³•åŠé™æ€æ–¹æ³•</strong>ï¼ˆç±»æ–¹æ³•ï¼Œç”¨<code>static</code>ä¿®é¥°ï¼‰ä¸èƒ½å£°æ˜ä¸ºæŠ½è±¡æ–¹æ³•ï¼Œä¹Ÿæ— æ³•å¯¹å…¶è¿›è¡Œé‡å†™<code>Override</code>ã€‚</li>
</ul>
<p>é‚£ä¹ˆé—®é¢˜çš„ç­”æ¡ˆå¾ˆæ˜äº†äº†ï¼Œå½“<code>Animal</code>ä¸­æœ‰æŠ½è±¡æ–¹æ³•æ—¶ï¼Œé‚£ä¹ˆä½¿ç”¨æ™®é€šç±»å°±ä¸è¡Œäº†ï¼Œå¿…é¡»ä½¿ç”¨æŠ½è±¡ç±»ï¼Œé‚£ä¹ˆ<strong>ç±»é‡Œæ²¡æœ‰æŠ½è±¡æ–¹æ³•ï¼Œå¯ä¸å¯ä»¥å£°æ˜ä¸ºæŠ½è±¡ç±»å‘¢ï¼Ÿæœ‰ä½•ä½œç”¨ï¼Ÿ</strong></p>
<hr>
<h2 id="æŠ½è±¡ç±»"><a href="#æŠ½è±¡ç±»" class="headerlink" title="æŠ½è±¡ç±»"></a>æŠ½è±¡ç±»</h2><p>æŠ½è±¡ç±»æ˜¯å¯¹<strong>å¯¹è±¡ï¼ˆç±»ï¼‰</strong>çš„æŠ½è±¡ï¼Œå’ŒæŠ½è±¡æ–¹æ³•ä¸€æ ·ï¼Œå£°æ˜æŠ½è±¡ç±»æ—¶åªéœ€è¦ä½¿ç”¨ä¿®é¥°ç¬¦â€œ<code>abstract</code>â€ å°±å¯ä»¥ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">(String food)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li><p>æŠ½è±¡æ–¹æ³•å¿…é¡»åŒ…å«åœ¨æŠ½è±¡ç±»é‡Œï¼Œä½†<strong>æŠ½è±¡ç±»é‡Œä¸ä¸€å®šè¦æœ‰æŠ½è±¡æ–¹æ³•</strong></p>
<p>å…ˆå›ç­”å‰ä¸€ä¸ªå°é—®é¢˜ï¼Œæ²¡æœ‰æŠ½è±¡æ–¹æ³•ï¼Œç±»ä¸€æ ·å¯ä»¥å£°æ˜ä¸ºæŠ½è±¡ç±»ï¼Œå’Œæ™®é€šç±»é™¤äº†ä¿®é¥°ç¬¦å…¶ä½™å†™æ³•ä¸€æ ·</p>
</li>
<li><p>æŠ½è±¡ç±»åªèƒ½è¢«ç»§æ‰¿ï¼Œä¸å¯ä»¥å®ä¾‹åŒ–</p>
<p>å¾ˆå¥½ç†è§£ï¼ŒæŠ½è±¡ç±»ä½œä¸ºæŠ½è±¡å‡ºæ¥çš„â€œæ¨¡å…·â€å­˜åœ¨ï¼Œè‡ªç„¶ä¸èƒ½â€œå®ä¾‹åŒ–â€ï¼Œåªæœ‰æŠ½è±¡ç±»çš„<strong>éæŠ½è±¡å­ç±»</strong>å¯ä»¥åˆ›å»ºå¯¹è±¡ã€‚ç¬¬äºŒä¸ªå°é—®é¢˜ç­”æ¡ˆä¹Ÿå°±æœ‰äº†ï¼Œæ²¡æœ‰æŠ½è±¡æ–¹æ³•çš„æŠ½è±¡ç±»çš„ä½œç”¨æ˜¯ï¼š<strong>å¼ºåˆ¶å­ç±»å»ç»§æ‰¿è¯¥ç±»ï¼Œå¹¶å¼ºåˆ¶ä¸å…è®¸è¢«å®ä¾‹åŒ–</strong>ã€‚åŸºäºæ­¤ï¼Œäººä»¬é€šå¸¸åœ¨è®¾è®¡é˜¶æ®µå†³å®šè¦ä¸è¦è®¾è®¡æŠ½è±¡ç±»ã€‚</p>
</li>
<li><p>æŠ½è±¡ç±»å¯ä»¥æœ‰æ— æ•°å­ç±»ï¼Œä½†ä¸€ä¸ªå­ç±»<strong>åªèƒ½ç»§æ‰¿ä¸€ä¸ªæŠ½è±¡ç±»</strong></p>
<p>è¿™ä¸ªå’Œæ™®é€šç±»ç›¸åŒï¼Œå­ç±»åªå…è®¸æœ‰ä¸€ä¸ªçˆ¶ç±»ã€‚<em>æ³¨æ„åŒºåˆ†æ¥å£ï¼šå­ç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ã€‚</em></p>
</li>
<li><p>æŠ½è±¡ç±»å¯ä»¥ç»§æ‰¿åˆ«çš„æŠ½è±¡ç±»ï¼Œå¯ä»¥å®ç°åˆ«çš„æ¥å£</p>
</li>
<li><p>æŠ½è±¡ç±»å¯ä»¥æœ‰æ„é€ å‡½æ•°ï¼Œåªæ˜¯æ˜¯ä¸ºå­ç±»æä¾›çš„</p>
<p>æŠ½è±¡ç±»å†…æ„é€ å‡½æ•°æ˜¯è¦æ±‚å­å‡½æ•°å¿…é¡»å®ç°çš„ï¼Œæ‰€ä»¥åœ¨å­ç±»çš„æ„é€ å‡½æ•°ä¸­<strong>å¿…é¡»</strong>åŠ ä¸€å¥</p>
<p><code>super();</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dog</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Dog</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">(String food)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//do something</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>â€‹</p>
</li>
</ol>
<p>æˆ‘ä»¬äº†è§£åˆ°è¿˜æœ‰ä¸€ç§ä¸èƒ½å®ä¾‹åŒ–ä¹Ÿæ²¡æœ‰æ–¹æ³•å…·ä½“å®ç°çš„æœºåˆ¶ï¼Œæ¥å£ï¼Œé‚£å’ŒæŠ½è±¡ç±»æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>
<hr>
<h2 id="æ¥å£"><a href="#æ¥å£" class="headerlink" title="æ¥å£"></a>æ¥å£</h2><p>æ¥å£æ˜¯å¯¹å¯¹è±¡è¡Œä¸ºçš„æŠ½è±¡ï¼Œé€šå¸¸ä»¥interfaceæ¥å£°æ˜ï¼Œæ˜¯æŠ½è±¡æ–¹æ³•çš„é›†åˆã€‚<strong>æ¥å£å¹¶ä¸æ˜¯ç±»</strong>ï¼Œç¼–å†™æ¥å£çš„æ–¹å¼å’Œç±»å¾ˆç›¸ä¼¼ï¼Œä½†æ˜¯å®ƒä»¬å±äºä¸åŒçš„æ¦‚å¿µã€‚ç±»æè¿°å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ã€‚æ¥å£åˆ™åŒ…å«ç±»è¦å®ç°çš„æ–¹æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Movable</span> </span>&#123;</span><br><span class="line">    <span class="comment">//è¿™é‡Œçœç•¥public static finalï¼Œå› ä¸ºæ¥å£é‡Œå˜é‡</span></span><br><span class="line">  	<span class="comment">//é»˜è®¤éƒ½æ˜¯å¸¸é‡ï¼Œè€Œä¸”ä¸èƒ½private</span></span><br><span class="line">    <span class="comment">/*public static final*/</span> String name = <span class="keyword">null</span>; </span><br><span class="line">    </span><br><span class="line">    <span class="comment">//è¿™é‡Œçœç•¥public abstractï¼Œå› ä¸ºæ¥å£é‡Œæ–¹æ³•é»˜è®¤éƒ½æ˜¯æŠ½è±¡çš„ï¼Œç¬¦åˆ</span></span><br><span class="line">    <span class="comment">//æŠ½è±¡æ–¹æ³•çš„ä¸€åˆ‡ç‰¹ç‚¹</span></span><br><span class="line">    <span class="comment">/*public abstract*/</span> <span class="function"><span class="keyword">void</span> <span class="title">walk</span><span class="params">()</span></span>; </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæ¥å£å†…åªèƒ½å£°æ˜<code>public</code>å¸¸é‡å’ŒæŠ½è±¡æ–¹æ³•</p>
<p><code>public static final</code> å’Œ <code>public abstract</code> å¯ä»¥çœç•¥</p>
</li>
<li><p>æ¥å£å†…æ²¡æœ‰<strong>æ„é€ å‡½æ•°</strong></p>
<p>å› ä¸ºæ¥å£<strong>ä¸èƒ½å®ä¾‹åŒ–</strong>ï¼Œè€Œä¸”æ¥å£ä¸æ˜¯ç±»ï¼Œåªæ˜¯ä¸€ç±»åŠ¨ä½œçš„é›†åˆï¼Œæ‰€ä»¥ä¸å­˜åœ¨â€œ<strong>æ„é€ </strong>â€çš„æ¦‚å¿µ</p>
</li>
<li><p>æ¥å£ä¸æ˜¯è¢«ç±»<strong>ç»§æ‰¿</strong>(<code>extends</code>)äº†ï¼Œè€Œæ˜¯è¦è¢«ç±»<strong>å®ç°</strong>(<code>implements</code>)ã€‚</p>
<p>å‡†ç¡®åœ°è¯´ï¼Œæ¥å£ä¸æ˜¯ç±»ï¼Œæ‰€ä»¥ä¸èƒ½è¢«ç»§æ‰¿ï¼Œå®ƒæ˜¯æ–¹æ³•çš„é›†åˆï¼Œå¯ä»¥è¢«å®ç°ã€‚ï¼ˆç”¨æ³•ç›¸ä¼¼ï¼Œç§°å‘¼ä¸åŒï¼‰</p>
</li>
<li><p>å­ç±»å¯ä»¥å®ç°<strong>å¤š</strong>ä¸ªæ¥å£</p>
<p>è¿™ä¸€ç‚¹æ˜¯ä¸å…¶ä»–ç±»æœ€æ˜æ˜¾çš„å·®å¼‚ï¼Œæ™®é€šç±»åŠæŠ½è±¡ç±»éƒ½åªèƒ½<strong>å•ä¸€ç»§æ‰¿</strong></p>
</li>
<li><p>æ¥å£å¯ä»¥ç»§æ‰¿åˆ«çš„<strong>æ¥å£</strong>ï¼Œä½†ä¸èƒ½ç»§æ‰¿<strong>ç±»</strong></p>
<p>â€‹</p>
</li>
</ol>
<hr>
<h2 id="æŠ½è±¡ç±»ä¸æ¥å£çš„åŒºåˆ«"><a href="#æŠ½è±¡ç±»ä¸æ¥å£çš„åŒºåˆ«" class="headerlink" title="æŠ½è±¡ç±»ä¸æ¥å£çš„åŒºåˆ«"></a>æŠ½è±¡ç±»ä¸æ¥å£çš„åŒºåˆ«</h2><ol>
<li><p><u>æŠ½è±¡ç±»æ˜¯å¯¹<strong>å¯¹è±¡</strong>çš„æŠ½è±¡ï¼›æ¥å£æ˜¯å¯¹<strong>è¡Œä¸º</strong>çš„æŠ½è±¡</u></p>
<p>è™½ç„¶ä¸¤è€…åœ¨ä½¿ç”¨çš„ç›¸ä¼¼ï¼Œç”šè‡³å¯ä»¥äº’æ¢è€Œä¸å‡ºç°bugï¼Œä½†ä¸¤è€…è®¾è®¡çš„åˆè¡·æ˜¯ä¸åŒçš„</p>
<ol>
<li>æŠ½è±¡ç±»æ˜¯<strong>ä¸€ç±»äº‹ç‰©</strong>ï¼Œåƒ<code>Animal</code>å¯¹<code>Dog</code>ï¼›</li>
<li>æ¥å£æ˜¯<strong>ä¸€ç±»åŠ¨ä½œ</strong>ï¼Œåƒ<code>Movable</code>å¯¹<code>walk()</code>ï¼›</li>
</ol>
</li>
<li><p><u>æŠ½è±¡ç±»å•ä¸€ç»§æ‰¿ï¼›æ¥å£å¯ä»¥å¤šâ€œç»§æ‰¿â€ï¼ˆ<em>å‡†ç¡®åœ°åº”è¯¥æ˜¯<strong>å®ç°</strong></em> ï¼‰</u></p>
</li>
<li><p>æŠ½è±¡ç±»å¯ä»¥åƒæ™®é€šç±»ä¸€æ ·å£°æ˜å„ç±»å­—æ®µï¼Œå„ç±»æ–¹æ³•ï¼›æ¥å£åªèƒ½å£°æ˜å¸¸é‡å’ŒæŠ½è±¡æ–¹æ³•</p>
<ol>
<li>æŠ½è±¡ç±»å¯ä»¥å®ç°åŒ…æ‹¬æŠ½è±¡æ–¹æ³•çš„å…¶ä»–ä»»æ„æ–¹æ³•ï¼›</li>
<li>æ¥å£åªæœ‰å¸¸é‡å’Œ<del>æŠ½è±¡æ–¹æ³•</del>ï¼ˆ<em>åœ¨æœ€æ–°çš„JAVA8ä¸­æƒ…å†µæœ‰æ‰€æ”¹å˜ï¼Œæœ¬ç¯‡åªç‚¹ä¸è®²</em>ï¼‰</li>
<li>æ¥å£å†…ä¸èƒ½æœ‰æ„é€ å‡½æ•°è€ŒæŠ½è±¡ç±»å¯ä»¥æœ‰ï¼›</li>
</ol>
</li>
<li><p>åŸºæœ¬åŒºåˆ«å°±æ˜¯è¿™äº›ï¼Œå¯ä»¥åœ¨æ—¥åçš„å®è·µä¸­æ…¢æ…¢æŒæ¡ï¼Œç›®å‰æ¥è¯´å¿…é¡»æŒæ¡çš„æ˜¯1.2.ä¸¤æ¡ã€‚</p>
</li>
</ol>
]]></content>
      <categories>
        <category>Programming</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Abstract Class</tag>
        <tag>Interface</tag>
      </tags>
  </entry>
</search>
